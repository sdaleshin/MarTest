/*!
 * Module dependencies.
 */

/*!
 * Inherits from SchemaType.
 */

/*!
 * ignore
 */

/*!
 * Module exports.
 */

function SchemaBuffer(e,t){SchemaType.call(this,e,t,"Buffer")}function handleSingle(e){return this.castForQuery(e)}function handleArray(e){var t=this;return e.map(function(e){return t.castForQuery(e)})}var SchemaType=require("../schematype"),CastError=SchemaType.CastError,MongooseBuffer=require("../types").Buffer,Binary=MongooseBuffer.Binary,Query=require("../query"),utils=require("../utils"),Document;SchemaBuffer.prototype.__proto__=SchemaType.prototype,SchemaBuffer.prototype.checkRequired=function(e,t){return SchemaType._isRef(this,e,t,!0)?null!=e:!!e&&!!e.length},SchemaBuffer.prototype.cast=function(e,t,n){if(SchemaType._isRef(this,e,t,n)){if(null==e)return e;Document||(Document=require("./../document"));if(e instanceof Document)return e.$__.wasPopulated=!0,e;if(Buffer.isBuffer(e))return e;if(!utils.isObject(e))throw new CastError("buffer",e,this.path);var r=t.$__fullPath(this.path),i=t.ownerDocument?t.ownerDocument():t,s=i.populated(r,!0),o=new s.options.model(e);return o.$__.wasPopulated=!0,o}e&&e._id&&(e=e._id);if(Buffer.isBuffer(e))return e instanceof MongooseBuffer||(e=new MongooseBuffer(e,[this.path,t])),e;if(e instanceof Binary){var o=new MongooseBuffer(e.value(!0),[this.path,t]);return o.subtype(e.sub_type),o}if(null===e)return e;var u=typeof e;if("string"==u||"number"==u||Array.isArray(e)){var o=new MongooseBuffer(e,[this.path,t]);return o}throw new CastError("buffer",e,this.path)},SchemaBuffer.prototype.$conditionalHandlers={$ne:handleSingle,$in:handleArray,$nin:handleArray,$gt:handleSingle,$lt:handleSingle,$gte:handleSingle,$lte:handleSingle},SchemaBuffer.prototype.castForQuery=function(e,t){var n;if(arguments.length===2){n=this.$conditionalHandlers[e];if(!n)throw new Error("Can't use "+e+" with Buffer.");return n.call(this,t)}return t=e,this.cast(t).toObject()},module.exports=SchemaBuffer;