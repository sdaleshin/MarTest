/*!
 * Module requirements.
 */

/*!
 * Inherits from SchemaType.
 */

/*!
 * ignore
 */

/*!
 * Module exports.
 */

function SchemaNumber(e,t){SchemaType.call(this,e,t,"Number")}function handleSingle(e){return this.cast(e)}function handleArray(e){var t=this;return e.map(function(e){return t.cast(e)})}var SchemaType=require("../schematype"),CastError=SchemaType.CastError,errorMessages=require("../error").messages,utils=require("../utils"),Document;SchemaNumber.prototype.__proto__=SchemaType.prototype,SchemaNumber.prototype.checkRequired=function(t,n){return SchemaType._isRef(this,t,n,!0)?null!=t:typeof t=="number"||t instanceof Number},SchemaNumber.prototype.min=function(e,t){this.minValidator&&(this.validators=this.validators.filter(function(e){return e[0]!=this.minValidator},this));if(null!=e){var n=t||errorMessages.Number.min;n=n.replace(/{MIN}/,e),this.validators.push([this.minValidator=function(t){return t===null||t>=e},n,"min"])}return this},SchemaNumber.prototype.max=function(e,t){this.maxValidator&&(this.validators=this.validators.filter(function(e){return e[0]!=this.maxValidator},this));if(null!=e){var n=t||errorMessages.Number.max;n=n.replace(/{MAX}/,e),this.validators.push([this.maxValidator=function(t){return t===null||t<=e},n,"max"])}return this},SchemaNumber.prototype.cast=function(e,t,n){if(SchemaType._isRef(this,e,t,n)){if(null==e)return e;Document||(Document=require("./../document"));if(e instanceof Document)return e.$__.wasPopulated=!0,e;if("number"==typeof e)return e;if(Buffer.isBuffer(e)||!utils.isObject(e))throw new CastError("number",e,this.path);var r=t.$__fullPath(this.path),i=t.ownerDocument?t.ownerDocument():t,s=i.populated(r,!0),o=new s.options.model(e);return o.$__.wasPopulated=!0,o}var u=e&&e._id?e._id:e;if(!isNaN(u)){if(null===u)return u;if(""===u)return null;"string"==typeof u&&(u=Number(u));if(u instanceof Number)return u;if("number"==typeof u)return u;if(u.toString&&!Array.isArray(u)&&u.toString()==Number(u))return new Number(u)}throw new CastError("number",e,this.path)},SchemaNumber.prototype.$conditionalHandlers={$lt:handleSingle,$lte:handleSingle,$gt:handleSingle,$gte:handleSingle,$ne:handleSingle,$in:handleArray,$nin:handleArray,$mod:handleArray,$all:handleArray},SchemaNumber.prototype.castForQuery=function(e,t){var n;if(arguments.length===2){n=this.$conditionalHandlers[e];if(!n)throw new Error("Can't use "+e+" with Number.");return n.call(this,t)}return t=this.cast(e),t==null?t:t},module.exports=SchemaNumber;