/*!
 * Module dependencies.
 */

/*!
 * ignore
 */

function create(e){function t(){}if(arguments.length>1)throw new Error("Adding properties is not supported");return t.prototype=e,new t}var mongodb=require("mongodb"),ReadPref=mongodb.ReadPreference,ObjectId=mongodb.ObjectID,RegExpClone=require("regexp-clone");exports.clone=function(t,n){if(t===undefined||t===null)return t;if(Array.isArray(t))return exports.cloneArray(t,n);if("Object"===t.constructor.name)return exports.cloneObject(t,n);if("Date"===t.constructor.name||"Function"===t.constructor.name)return new t.constructor(+t);if("RegExp"===t.constructor.name)return RegExpClone(t);if(t instanceof ObjectId)return new ObjectId(t.id);if(t.valueOf)return t.valueOf()};var clone=exports.clone,cloneObject=exports.cloneObject=function(t,n){var r=n&&n.retainKeyOrder,i=n&&n.minimize,s={},o,u,a,f,l;if(r)for(f in t){a=clone(t[f],n);if(!i||"undefined"!=typeof a)o||(o=!0),s[f]=a}else{u=Object.keys(t),l=u.length;while(l--){f=u[l],a=clone(t[f],n);if(!i||"undefined"!=typeof a)o||(o=!0),s[f]=a}}return i?o&&s:s},cloneArray=exports.cloneArray=function(t,n){var r=[];for(var i=0,s=t.length;i<s;i++)r.push(clone(t[i],n));return r},tick=exports.tick=function(t){if("function"!=typeof t)return;return function(){var e=arguments;soon(function(){t.apply(this,e)})}},merge=exports.merge=function e(t,n){var r=Object.keys(n),i=r.length,s;while(i--)s=r[i],"undefined"==typeof t[s]?t[s]=n[s]:exports.isObject(n[s])?e(t[s],n[s]):t[s]=n[s]},mergeClone=exports.mergeClone=function t(e,n){var r=Object.keys(n),i=r.length,s;while(i--)s=r[i],"undefined"==typeof e[s]?e[s]=clone(n[s],{retainKeyOrder:1}):exports.isObject(n[s])?t(e[s],n[s]):e[s]=clone(n[s],{retainKeyOrder:1})};exports.readPref=function(t,n){Array.isArray(t)&&(n=t[1],t=t[0]);switch(t){case"p":t="primary";break;case"pp":t="primaryPreferred";break;case"s":t="secondary";break;case"sp":t="secondaryPreferred";break;case"n":t="nearest"}return new ReadPref(t,n)};var toString=Object.prototype.toString;exports.toString=function(e){return toString.call(e)},exports.isObject=function(e){return"[object Object]"==exports.toString(e)},exports.isArray=function(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"==exports.toString(e)},exports.keys=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},exports.create="function"==typeof Object.create?Object.create:create,exports.inherits=function(e,t){e.prototype=exports.create(t.prototype),e.prototype.constructor=e};var soon=exports.soon="function"==typeof setImmediate?setImmediate:process.nextTick;exports.mongo=mongodb;