var BaseCommand=require("./base_command").BaseCommand,inherits=require("util").inherits,DeleteCommand=exports.DeleteCommand=function(e,t,n,r){BaseCommand.call(this);var i=n;if(Buffer.isBuffer(i)){var s=i[0]|i[1]<<8|i[2]<<16|i[3]<<24;if(s!=i.length){var o=new Error("delete raw message size does not match message header size ["+i.length+"] != ["+s+"]");throw o.name="MongoError",o}}this.flags=r,this.collectionName=t,this.selector=n,this.db=e};inherits(DeleteCommand,BaseCommand),DeleteCommand.OP_DELETE=2006,DeleteCommand.prototype.toBinary=function(e){if(!~this.collectionName.indexOf("\0")){var t=4+Buffer.byteLength(this.collectionName)+1+4+this.db.bson.calculateObjectSize(this.selector,!1,!0)+16;if(!e.disableDriverBSONSizeCheck&&t>e.maxBsonSize)throw new Error("Document exceeds maximum allowed bson size of "+e.maxBsonSize+" bytes");if(e.disableDriverBSONSizeCheck&&t>e.maxMessageSizeBytes)throw new Error("Command exceeds maximum message size of "+e.maxMessageSizeBytes+" bytes");var n=0,r=new Buffer(t);r[n+3]=t>>24&255,r[n+2]=t>>16&255,r[n+1]=t>>8&255,r[n]=t&255,n+=4,r[n+3]=this.requestId>>24&255,r[n+2]=this.requestId>>16&255,r[n+1]=this.requestId>>8&255,r[n]=this.requestId&255,n+=4,r[n++]=0,r[n++]=0,r[n++]=0,r[n++]=0,r[n+3]=DeleteCommand.OP_DELETE>>24&255,r[n+2]=DeleteCommand.OP_DELETE>>16&255,r[n+1]=DeleteCommand.OP_DELETE>>8&255,r[n]=DeleteCommand.OP_DELETE&255,n+=4,r[n++]=0,r[n++]=0,r[n++]=0,r[n++]=0,n=n+r.write(this.collectionName,n,"utf8")+1,r[n-1]=0,r[n+3]=this.flags>>24&255,r[n+2]=this.flags>>16&255,r[n+1]=this.flags>>8&255,r[n]=this.flags&255,n+=4;var i=0;return Buffer.isBuffer(this.selector)?(i=this.selector.length,this.selector.copy(r,n)):i=this.db.bson.serializeWithBufferAndIndex(this.selector,this.checkKeys,r,n)-n+1,r[n+3]=i>>24&255,r[n+2]=i>>16&255,r[n+1]=i>>8&255,r[n]=i&255,n+=i,r[n-1]=0,r}throw new Error("namespace cannot contain a null character")};