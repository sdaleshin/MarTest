function Argv(e,t){function u(e){n.showHelp(),e&&console.error(e),process.exit(1)}function h(){function o(e,n){var s=Number(n),o=typeof n!="string"||isNaN(s)?n:s;r.strings[e]&&(o=n),setKey(t,e.split("."),o),(i[e]||[]).forEach(function(n){t[n]=t[e]})}var t={_:[],$0:n.$0};Object.keys(r.bools).forEach(function(e){o(e,f[e]||!1)});for(var l=0;l<e.length;l++){var c=e[l];if(c==="--"){t._.push.apply(t._,e.slice(l+1));break}if(c.match(/^--.+=/)){var h=c.match(/^--([^=]+)=([\s\S]*)$/);o(h[1],h[2])}else if(c.match(/^--no-.+/)){var p=c.match(/^--no-(.+)/)[1];o(p,!1)}else if(c.match(/^--.+/)){var p=c.match(/^--(.+)/)[1],d=e[l+1];d!==undefined&&!d.match(/^-/)&&!r.bools[p]&&(i[p]?!r.bools[i[p]]:!0)?(o(p,d),l++):/^(true|false)$/.test(d)?(o(p,d==="true"),l++):o(p,!0)}else if(c.match(/^-[^-]+/)){var v=c.slice(1,-1).split(""),m=!1;for(var g=0;g<v.length;g++){if(v[g+1]&&v[g+1].match(/\W/)){o(v[g],c.slice(g+2)),m=!0;break}o(v[g],!0)}if(!m){var p=c.slice(-1)[0];e[l+1]&&!e[l+1].match(/^-/)&&!r.bools[p]&&(i[p]?!r.bools[i[p]]:!0)?(o(p,e[l+1]),l++):e[l+1]&&/true|false/.test(e[l+1])?(o(p,e[l+1]==="true"),l++):o(p,!0)}}else{var y=Number(c);t._.push(r.strings._||isNaN(y)?c:y)}}Object.keys(f).forEach(function(e){e in t||(t[e]=f[e],e in i&&(t[i[e]]=f[e]))}),s._&&t._.length<s._&&u("Not enough non-option arguments: got "+t._.length+", need at least "+s._);var b=[];return Object.keys(s).forEach(function(e){t[e]||b.push(e)}),b.length&&u("Missing required arguments: "+b.join(", ")),a.forEach(function(e){try{e(t)===!1&&u("Argument check failed: "+e.toString())}catch(n){u(n)}}),t}function p(e){return Math.max.apply(null,e.map(function(e){return e.length}))}var n={};t||(t=process.cwd()),n.$0=process.argv.slice(0,2).map(function(e){var n=rebase(t,e);return e.match(/^\//)&&n.length<e.length?n:e}).join(" "),process.env._!=undefined&&process.argv[1]==process.env._&&(n.$0=process.env._.replace(path.dirname(process.execPath)+"/",""));var r={bools:{},strings:{}};n.boolean=function(e){return Array.isArray(e)||(e=[].slice.call(arguments)),e.forEach(function(e){r.bools[e]=!0}),n},n.string=function(e){return Array.isArray(e)||(e=[].slice.call(arguments)),e.forEach(function(e){r.strings[e]=!0}),n};var i={};n.alias=function(e,t){if(typeof e=="object")Object.keys(e).forEach(function(t){n.alias(t,e[t])});else if(Array.isArray(t))t.forEach(function(t){n.alias(e,t)});else{var r=(i[e]||[]).concat(i[t]||[]).concat(e,t);i[e]=r.filter(function(t){return t!=e}),i[t]=r.filter(function(e){return e!=t})}return n};var s={};n.demand=function(e){return typeof e=="number"?(s._||(s._=0),s._+=e):Array.isArray(e)?e.forEach(function(e){n.demand(e)}):s[e]=!0,n};var o;n.usage=function(e,t){return!t&&typeof e=="object"&&(t=e,e=null),o=e,t&&n.options(t),n};var a=[];n.check=function(e){return a.push(e),n};var f={};n.default=function(e,t){return typeof e=="object"?Object.keys(e).forEach(function(t){n.default(t,e[t])}):f[e]=t,n};var l={};n.describe=function(e,t){return typeof e=="object"?Object.keys(e).forEach(function(t){n.describe(t,e[t])}):l[e]=t,n},n.parse=function(e){return Argv(e).argv},n.option=n.options=function(e,t){if(typeof e=="object")Object.keys(e).forEach(function(t){n.options(t,e[t])});else{t.alias&&n.alias(e,t.alias),t.demand&&n.demand(e),typeof t.default!="undefined"&&n.default(e,t.default),(t.boolean||t.type==="boolean")&&n.boolean(e),(t.string||t.type==="string")&&n.string(e);var r=t.describe||t.description||t.desc;r&&n.describe(e,r)}return n};var c=null;return n.wrap=function(e){return c=e,n},n.showHelp=function(e){e||(e=console.error),e(n.help())},n.help=function(){var e=Object.keys(Object.keys(l).concat(Object.keys(s)).concat(Object.keys(f)).reduce(function(e,t){return t!=="_"&&(e[t]=!0),e},{})),t=e.length?["Options:"]:[];o&&t.unshift(o.replace(/\$0/g,n.$0),"");var u=e.reduce(function(e,t){return e[t]=[t].concat(i[t]||[]).map(function(e){return(e.length>1?"--":"-")+e}).join(", "),e},{}),a=p(Object.keys(u).map(function(e){return u[e]||""})),h=p(Object.keys(l).map(function(e){return l[e]||""}));return e.forEach(function(e){var n=u[e],i=l[e]||"";c&&(i=wordwrap(a+4,c)(i).slice(a+4));var o=(new Array(Math.max(a-n.length+3,0))).join(" "),p=(new Array(Math.max(h-i.length+1,0))).join(" "),d=null;r.bools[e]&&(d="[boolean]"),r.strings[e]&&(d="[string]"),!c&&p.length>0&&(i+=p);var v="  "+n+o,m=[d,s[e]?"[required]":null,f[e]!==undefined?"[default: "+JSON.stringify(f[e])+"]":null].filter(Boolean).join("  "),g=[i,m].filter(Boolean).join("  ");if(c){var y=i.split("\n"),b=y.slice(-1)[0].length+(y.length===1?v.length:0);g=i+(b+m.length>c-2?"\n"+(new Array(c-m.length+1)).join(" ")+m:(new Array(c-m.length-b+1)).join(" ")+m)}t.push(v+g)}),t.push(""),t.join("\n")},Object.defineProperty(n,"argv",{get:h,enumerable:!0}),n}function rebase(e,t){var n=path.normalize(t).split("/").slice(1),r=path.normalize(e).split("/").slice(1);for(var i=0;n[i]&&n[i]==r[i];i++);n.splice(0,i),r.splice(0,i);var s=path.normalize(r.map(function(){return".."}).concat(n).join("/")).replace(/\/$/,"").replace(/^$/,".");return s.match(/^[.\/]/)?s:"./"+s}function setKey(e,t,n){var r=e;t.slice(0,-1).forEach(function(e){r[e]===undefined&&(r[e]={}),r=r[e]});var i=t[t.length-1];r[i]===undefined||typeof r[i]=="boolean"?r[i]=n:Array.isArray(r[i])?r[i].push(n):r[i]=[r[i],n]}var path=require("path"),wordwrap=require("wordwrap"),inst=Argv(process.argv.slice(2));Object.keys(inst).forEach(function(e){Argv[e]=typeof inst[e]=="function"?inst[e].bind(inst):inst[e]});var exports=module.exports=Argv;exports.rebase=rebase;