/** vim: et:ts=4:sw=4:sts=4
 * @license amdefine 0.1.0 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/amdefine for details
 */

function amdefine(e,t){function a(e){var t,n;for(t=0;e[t];t+=1){n=e[t];if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===1&&(e[2]===".."||e[0]===".."))break;t>0&&(e.splice(t-1,2),t-=2)}}}function f(e,t){var n;return e&&e.charAt(0)==="."&&t&&(n=t.split("/"),n=n.slice(0,n.length-1),n=n.concat(e.split("/")),a(n),e=n.join("/")),e}function l(e){return function(t){return f(t,e)}}function c(e){function t(t){r[e]=t}return t.fromText=function(e,t){throw new Error("amdefine does not implement load.fromText")},t}function h(n,s,u){var a,f,l,c;if(n)f=r[n]={},l={id:n,uri:__filename,exports:f},a=o(t,f,l,n);else{if(i)throw new Error("amdefine with no module ID cannot be called more than once per file.");i=!0,f=e.exports,l=e,a=o(t,f,l,e.id)}s&&(s=s.map(function(e){return a(e)})),typeof u=="function"?c=u.apply(l.exports,s):c=u,c!==undefined&&(l.exports=c,n&&(r[n]=l.exports))}function p(e,t,r){Array.isArray(e)?(r=t,t=e,e=undefined):typeof e!="string"&&(r=e,e=t=undefined),t&&!Array.isArray(t)&&(r=t,t=undefined),t||(t=["require","exports","module"]),e?n[e]=[e,t,r]:h(e,t,r)}var n={},r={},i=!1,s=require("path"),o,u;return o=function(e,t,n,r){function i(i,s){if(typeof i=="string")return u(e,t,n,i,r);i=i.map(function(i){return u(e,t,n,i,r)}),process.nextTick(function(){s.apply(null,i)})}return i.toUrl=function(e){return e.indexOf(".")===0?f(e,s.dirname(n.filename)):e},i},t=t||function(){return e.require.apply(e,arguments)},u=function(e,t,i,s,a){var p=s.indexOf("!"),d=s,v,m;if(p===-1){s=f(s,a);if(s==="require")return o(e,t,i,a);if(s==="exports")return t;if(s==="module")return i;if(r.hasOwnProperty(s))return r[s];if(n[s])return h.apply(null,n[s]),r[s];if(e)return e(d);throw new Error("No module with ID: "+s)}return v=s.substring(0,p),s=s.substring(p+1,s.length),m=u(e,t,i,v,a),m.normalize?s=m.normalize(s,l(a)):s=f(s,a),r[s]?r[s]:(m.load(s,o(e,t,i,a),c(s),{}),r[s])},p.require=function(e){if(r[e])return r[e];if(n[e])return h.apply(null,n[e]),r[e]},p.amd={},p}module.exports=amdefine;