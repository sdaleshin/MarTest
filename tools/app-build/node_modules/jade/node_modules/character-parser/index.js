function parse(e,t,n){n=n||{},t=t||exports.defaultState();var r=n.start||0,i=n.end||e.length,s=r;while(s<i){if(t.roundDepth<0||t.curlyDepth<0||t.squareDepth<0)throw new SyntaxError("Mismatched Bracket: "+e[s-1]);exports.parseChar(e[s++],t)}return t}function parseMax(e,t){t=t||{};var n=t.start||0,r=n,i=exports.defaultState();while(i.roundDepth>=0&&i.curlyDepth>=0&&i.squareDepth>=0){if(r>=e.length)throw new Error("The end of the string was reached with no closing bracket found.");exports.parseChar(e[r++],i)}var s=r-1;return{start:n,end:s,src:e.substring(n,s)}}function parseUntil(e,t,n){n=n||{};var r=n.includeLineComment||!1,i=n.start||0,s=i,o=exports.defaultState();while(o.isString()||o.regexp||o.blockComment||!r&&o.lineComment||!startsWith(e,t,s))exports.parseChar(e[s++],o);var u=s;return{start:i,end:u,src:e.substring(i,u)}}function parseChar(e,t){if(e.length!==1)throw new Error("Character must be a string of length 1");t=t||exports.defaultState();var n=t.blockComment||t.lineComment,r=t.history?t.history[0]:"";return t.lineComment?e==="\n"&&(t.lineComment=!1):t.blockComment?t.lastChar==="*"&&e==="/"&&(t.blockComment=!1):t.singleQuote?e==="'"&&!t.escaped?t.singleQuote=!1:e==="\\"&&!t.escaped?t.escaped=!0:t.escaped=!1:t.doubleQuote?e==='"'&&!t.escaped?t.doubleQuote=!1:e==="\\"&&!t.escaped?t.escaped=!0:t.escaped=!1:t.regexp?e==="/"&&!t.escaped?t.regexp=!1:e==="\\"&&!t.escaped?t.escaped=!0:t.escaped=!1:r==="/"&&e==="/"?(t.history=t.history.substr(1),t.lineComment=!0):r==="/"&&e==="*"?(t.history=t.history.substr(1),t.blockComment=!0):e==="/"&&isRegexp(t.history)?t.regexp=!0:e==="'"?t.singleQuote=!0:e==='"'?t.doubleQuote=!0:e==="("?t.roundDepth++:e===")"?t.roundDepth--:e==="{"?t.curlyDepth++:e==="}"?t.curlyDepth--:e==="["?t.squareDepth++:e==="]"&&t.squareDepth--,!t.blockComment&&!t.lineComment&&!n&&(t.history=e+t.history),t}function State(){this.lineComment=!1,this.blockComment=!1,this.singleQuote=!1,this.doubleQuote=!1,this.regexp=!1,this.escaped=!1,this.roundDepth=0,this.curlyDepth=0,this.squareDepth=0,this.history=""}function startsWith(e,t,n){return e.substr(n||0,t.length)===t}function isPunctuator(e){var t=e.charCodeAt(0);switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:case 37:case 38:case 42:case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 33:case 61:return!0;default:return!1}}function isKeyword(e){return e==="if"||e==="in"||e==="do"||e==="var"||e==="for"||e==="new"||e==="try"||e==="let"||e==="this"||e==="else"||e==="case"||e==="void"||e==="with"||e==="enum"||e==="while"||e==="break"||e==="catch"||e==="throw"||e==="const"||e==="yield"||e==="class"||e==="super"||e==="return"||e==="typeof"||e==="delete"||e==="switch"||e==="export"||e==="import"||e==="default"||e==="finally"||e==="extends"||e==="function"||e==="continue"||e==="debugger"||e==="package"||e==="private"||e==="interface"||e==="instanceof"||e==="implements"||e==="protected"||e==="public"||e==="static"||e==="yield"||e==="let"}function isRegexp(e){return e=e.replace(/^\s*/,""),e[0]===")"?!1:e[0]==="}"?!0:isPunctuator(e[0])?!0:/^\w+\b/.test(e)&&isKeyword(/^\w+\b/.exec(e)[0].split("").reverse().join(""))?!0:!1}exports=module.exports=parse,exports.parse=parse,exports.parseMax=parseMax,exports.parseUntil=parseUntil,exports.parseChar=parseChar,exports.defaultState=function(){return new State},State.prototype.isString=function(){return this.singleQuote||this.doubleQuote},State.prototype.isComment=function(){return this.lineComment||this.blockComment},State.prototype.isNesting=function(){return this.isString()||this.isComment()||this.regexp||this.roundDepth>0||this.curlyDepth>0||this.squareDepth>0},exports.isPunctuator=isPunctuator,exports.isKeyword=isKeyword;