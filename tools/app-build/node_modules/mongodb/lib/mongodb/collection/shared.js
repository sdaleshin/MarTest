var _hasWriteConcern=function(e){return e==1||e.w>0||e.w=="majority"||e.j==1||e.journal==1||e.fsync==1},_setWriteConcernHash=function(e){var t={};return e.w!=null&&(t.w=e.w),e.journal==1&&(t.j=e.journal),e.j==1&&(t.j=e.j),e.fsync==1&&(t.fsync=e.fsync),e.wtimeout!=null&&(t.wtimeout=e.wtimeout),t},_getWriteConcern=function(e,t){var n={w:1};t.w!=null||typeof t.j=="boolean"||typeof t.journal=="boolean"||typeof t.fsync=="boolean"?n=_setWriteConcernHash(t):typeof t.safe=="boolean"?n={w:t.safe?1:0}:t.safe!=null&&typeof t.safe=="object"?n=_setWriteConcernHash(t.safe):e.opts.w!=null||typeof e.opts.j=="boolean"||typeof e.opts.journal=="boolean"||typeof e.opts.fsync=="boolean"?n=_setWriteConcernHash(e.opts):typeof e.opts.safe=="boolean"?n={w:e.opts.safe?1:0}:e.db.safe.w!=null||typeof e.db.safe.j=="boolean"||typeof e.db.safe.journal=="boolean"||typeof e.db.safe.fsync=="boolean"?n=_setWriteConcernHash(e.db.safe):e.db.options.w!=null||typeof e.db.options.j=="boolean"||typeof e.db.options.journal=="boolean"||typeof e.db.options.fsync=="boolean"?n=_setWriteConcernHash(e.db.options):typeof e.db.safe=="boolean"&&(n={w:e.db.safe?1:0});if(n.w<1&&(n.journal==1||n.j==1||n.fsync==1))throw new Error("No acknowlegement using w < 1 cannot be combined with journal:true or fsync:true");return n},_getReadConcern=function(e,t){return t.readPreference?t.readPreference:e.readPreference?e.readPreference:e.db.readPreference?e.readPreference:"primary"},checkCollectionName=function(t){if("string"!=typeof t)throw Error("collection name must be a String");if(!t||t.indexOf("..")!=-1)throw Error("collection names cannot be empty");if(t.indexOf("$")!=-1&&t.match(/((^\$cmd)|(oplog\.\$main))/)==null)throw Error("collection names must not contain '$'");if(t.match(/^\.|\.$/)!=null)throw Error("collection names must not start or end with '.'");if(!!~t.indexOf("\0"))throw new Error("collection names cannot contain a null character")},normalizeHintField=function(t){var n=null;if(typeof t=="string")n=t;else if(Array.isArray(t))n={},t.forEach(function(e){n[e]=1});else if(t!=null&&typeof t=="object"){n={};for(var r in t)n[r]=t[r]}return n};exports._getWriteConcern=_getWriteConcern,exports._hasWriteConcern=_hasWriteConcern,exports._getReadConcern=_getReadConcern,exports.checkCollectionName=checkCollectionName,exports.normalizeHintField=normalizeHintField;