/*!
 * Connect - vhost
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 */

module.exports=function(t,n){if(!t)throw new Error("vhost hostname required");if(!n)throw new Error("vhost server required");var r=new RegExp("^"+t.replace(/[^*\w]/g,"\\$&").replace(/[*]/g,"(?:.*?)")+"$","i");return n.onvhost&&n.onvhost(t),function(t,i,s){if(!t.headers.host)return s();var o=t.headers.host.split(":")[0];if(!r.test(o))return s();if("function"==typeof n)return n(t,i,s);n.emit("request",t,i)}};