/*!
 * Connect - session - Session
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 */

var utils=require("../../utils"),Session=module.exports=function(t,n){Object.defineProperty(this,"req",{value:t}),Object.defineProperty(this,"id",{value:t.sessionID}),"object"==typeof n&&utils.merge(this,n)};Session.prototype.touch=function(){return this.resetMaxAge()},Session.prototype.resetMaxAge=function(){return this.cookie.maxAge=this.cookie.originalMaxAge,this},Session.prototype.save=function(e){return this.req.sessionStore.set(this.id,this,e||function(){}),this},Session.prototype.reload=function(e){var t=this.req,n=this.req.sessionStore;return n.get(this.id,function(r,i){if(r)return e(r);if(!i)return e(new Error("failed to load session"));n.createSession(t,i),e()}),this},Session.prototype.destroy=function(e){return delete this.req.session,this.req.sessionStore.destroy(this.id,e),this},Session.prototype.regenerate=function(e){return this.req.sessionStore.regenerate(this.req,e),this};