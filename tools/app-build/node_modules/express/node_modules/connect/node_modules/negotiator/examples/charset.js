(function(){var e,t,n,r,i,s,o,u,a,f,l;n=require("../lib/negotiator").Negotiator,i=require("http"),e=require("buffer").Buffer,t=require("iconv").Iconv,s=new t("UTF-8","ISO-8859-1"),u="Ã«",a={"utf-8":u,"iso-8859-1":s.convert(new e(u))},r=function(){var e;e=[];for(o in a)l=a[o],e.push(o);return e}(),f=i.createServer(function(e,t){var i,s;return s=new n(e),console.log("Accept-Charset: "+e.headers["accept-charset"]),console.log("Preferred: "+s.preferredCharsets()),console.log("Possible: "+s.preferredCharsets(r)),i=s.preferredCharset(r),console.log("Selected: "+i),i?(t.writeHead(200,{"Content-Type":"text/html; charset="+i}),t.end(a[i])):(t.writeHead(406),t.end())}),f.listen(8080)}).call(this);