function BreakEventHandler(e,t,n,r){this._config=e,this._frontendClient=t,this._debuggerClient=n,this._scriptManager=r,this._callFramesProvider=new CallFramesProvider(e,n),this._registerDebuggerEventHandlers()}var convert=require("./convert"),CallFramesProvider=require("./CallFramesProvider").CallFramesProvider,callbackForNextBreak;Object.defineProperties(BreakEventHandler.prototype,{continueToLocationBreakpointId:{writable:!0,value:null},callbackForNextBreak:{get:function(){return callbackForNextBreak},set:function(e){if(e&&callbackForNextBreak)throw new Error("Cannot set multiple callbacks for the next break.");callbackForNextBreak=e}}}),BreakEventHandler.prototype._registerDebuggerEventHandlers=function(){this._debuggerClient.on("break",this._onBreak.bind(this)),this._debuggerClient.on("exception",this._onBreak.bind(this))},BreakEventHandler.prototype._onBreak=function(e){var t=e.script.id,n=e.breakpoints,r=this._scriptManager.findScriptByID(t);if(!r||r.hidden){this._debuggerClient.request("continue",{stepaction:"out"});return}if(this.callbackForNextBreak){var i=this.callbackForNextBreak;this.callbackForNextBreak=null,i(e);return}this.continueToLocationBreakpointId!==null&&this._debuggerClient.clearBreakpoint(this.continueToLocationBreakpointId,function(e,t){e?this._frontendClient.sendLogToConsole("warning",e):this.continueToLocationBreakpointId=null}.bind(this)),this.sendBacktraceToFrontend(e.exception,n)},BreakEventHandler.prototype.fetchCallFrames=function(e){this._callFramesProvider.fetchCallFrames(e)},BreakEventHandler.prototype.sendBacktraceToFrontend=function(e,t){this.fetchCallFrames(function(n,r){n?this._frontendClient.sendLogToConsole("error",n):this._frontendClient.sendEvent("Debugger.paused",{callFrames:r,reason:e?"exception":"other",data:e?convert.v8RefToInspectorObject(e):null,hitBreakpoints:t})}.bind(this))},exports.BreakEventHandler=BreakEventHandler;