function PageAgent(e,t,n){this._debuggerClient=t,this._scriptManager=n,this._scriptStorage=new ScriptFileStorage(e.isScriptHidden)}function createUniqueLoaderId(){var e=String(Math.random()).slice(2);return Date.now()+"-"+e}var fs=require("fs"),path=require("path"),async=require("async"),convert=require("./convert.js"),ScriptFileStorage=require("./ScriptFileStorage.js").ScriptFileStorage;PageAgent.prototype={enable:function(e,t){t()},canShowFPSCounter:function(e,t){t(null,{show:!1})},canContinuouslyPaint:function(e,t){t(null,{value:!1})},setTouchEmulationEnabled:function(e,t){t()},getResourceTree:function(e,t){this._debuggerClient.isRunning?this._doGetResourceTree(e,t):this._debuggerClient.once("connect",this._doGetResourceTree.bind(this,e,t))},_doGetResourceTree:function(e,t){var n="[process.cwd(), process.mainModule ? process.mainModule.filename : process.argv[1]]";async.waterfall([this._debuggerClient.evaluateGlobal.bind(this._debuggerClient,n),function(e,t){t(null,e[0],e[1])},this._resolveMainAppScript.bind(this),this._getResourceTreeForAppScript.bind(this)],t)},_resolveMainAppScript:function(e,t,n){this._scriptManager.mainAppScript=t;if(t==null)return n(null,e,t);fs.stat(t,function(r,i){return r&&!/\.js$/.test(t)&&(t+=".js"),n(null,e,t)})},_getResourceTreeForAppScript:function(e,t,n){async.waterfall([this._scriptStorage.findAllApplicationScripts.bind(this._scriptStorage,e,t),this._createResourceTreeResponse.bind(this,t)],n)},_createResourceTreeResponse:function(e,t,n){var r=t.map(function(e){return{url:convert.v8NameToInspectorUrl(e),type:"Script",mimeType:"text/javascript"}});n(null,{frameTree:{frame:{id:"nodeinspector-toplevel-frame",url:convert.v8NameToInspectorUrl(e),loaderId:createUniqueLoaderId(),_isNodeInspectorScript:!0},resources:r}})},getResourceContent:function(e,t){var n=convert.inspectorUrlToV8Name(e.url);if(n===""){var r="// There is no main module loaded in node.\n// This is expected when you are debugging node's interactive REPL console.";return process.nextTick(this._convertScriptSourceToGetResourceResponse.bind(this,r,t))}async.waterfall([this._scriptStorage.load.bind(this._scriptStorage,n),this._convertScriptSourceToGetResourceResponse.bind(this)],t)},_convertScriptSourceToGetResourceResponse:function(e,t){return t(null,{content:e})},reload:function(e,t){t()}},exports.PageAgent=PageAgent;