var events=require("events"),convert=require("./convert.js"),DebuggerClient=require("./DebuggerClient").DebuggerClient,ScriptManager=require("./ScriptManager").ScriptManager,FrontendClient=require("./FrontendClient").FrontendClient,FrontendCommandHandler=require("./FrontendCommandHandler").FrontendCommandHandler,BreakEventHandler=require("./BreakEventHandler").BreakEventHandler;exports.create=function(e,t){function a(e){s.isConnected&&s.sendInspectorDetached(e),n.close()}function f(e){var t=e.toString();e.helpString&&(t+="\n"+e.helpString),s.sendLogToConsole("error",t)}var n,r,i,s,o,u;return n=Object.create(events.EventEmitter.prototype,{close:{value:function(){o.close(),this.emit("close")}},join:{value:function(n){s=new FrontendClient(n),o=new DebuggerClient(e),r=new ScriptManager(t.isScriptHidden,s,o),u=new BreakEventHandler(t,s,o,r),i=new FrontendCommandHandler(t,s,o,u,r),s.on("close",this.close.bind(this)),o.on("close",a),o.on("error",f)}}}),n};