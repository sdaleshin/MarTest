/*!
 * socket.io-node
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */

function HTTPPolling(e,t,n){HTTPTransport.call(this,e,t,n)}var HTTPTransport=require("./http");exports=module.exports=HTTPPolling,HTTPPolling.prototype.__proto__=HTTPTransport.prototype,HTTPPolling.prototype.name="httppolling",HTTPPolling.prototype.setHandlers=function(){HTTPTransport.prototype.setHandlers.call(this),this.socket.removeListener("end",this.bound.end),this.socket.removeListener("close",this.bound.close)},HTTPPolling.prototype.setHeartbeatInterval=function(){return this},HTTPPolling.prototype.handleRequest=function(e){HTTPTransport.prototype.handleRequest.call(this,e);if(e.method=="GET"){var t=this;this.pollTimeout=setTimeout(function(){t.packet({type:"noop"}),t.log.debug(t.name+" closed due to exceeded duration")},this.manager.get("polling duration")*1e3),this.log.debug("setting poll timeout")}},HTTPPolling.prototype.clearPollTimeout=function(){return this.pollTimeout&&(clearTimeout(this.pollTimeout),this.pollTimeout=null,this.log.debug("clearing poll timeout")),this},HTTPPolling.prototype.clearTimeouts=function(){HTTPTransport.prototype.clearTimeouts.call(this),this.clearPollTimeout()},HTTPPolling.prototype.doWrite=function(){this.clearPollTimeout()},HTTPPolling.prototype.write=function(e,t){this.doWrite(e),this.response.end(),this.onClose()},HTTPPolling.prototype.end=function(e){return this.clearPollTimeout(),HTTPTransport.prototype.end.call(this,e)};