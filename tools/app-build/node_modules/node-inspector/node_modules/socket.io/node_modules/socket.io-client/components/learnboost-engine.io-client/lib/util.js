/**
 * Parses an URI
 *
 * @author Steven Levithan <stevenlevithan.com> (MIT license)
 * @api private
 */

var pageLoaded=!1,global="undefined"!=typeof window?window:global;exports.inherits=function(t,n){function r(){}r.prototype=n.prototype,t.prototype=new r},exports.keys=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t},exports.on=function(e,t,n,r){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,r)},exports.load=function(e){if(global.document&&document.readyState==="complete"||pageLoaded)return e();exports.on(global,"load",e,!1)},"undefined"!=typeof window&&exports.load(function(){pageLoaded=!0}),exports.defer=function(e){if(!exports.ua.webkit||"undefined"!=typeof importScripts)return e();exports.load(function(){setTimeout(e,100)})};var rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rtrimLeft=/^\s+/,rtrimRight=/\s+$/;exports.parseJSON=function(e){if("string"!=typeof e||!e)return null;e=e.replace(rtrimLeft,"").replace(rtrimRight,"");if(global.JSON&&JSON.parse)return JSON.parse(e);if(rvalidchars.test(e.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,"")))return(new Function("return "+e))()},exports.ua={},exports.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return e.withCredentials!=undefined}(),exports.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),exports.ua.gecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent),exports.ua.android="undefined"!=typeof navigator&&/android/i.test(navigator.userAgent),exports.ua.ios="undefined"!=typeof navigator&&/^(iPad|iPhone|iPod)$/.test(navigator.platform),exports.ua.ios6=exports.ua.ios&&/OS 6_/.test(navigator.userAgent),exports.request=function(t){if("undefined"!=typeof process){var n=require("xmlhttprequest").XMLHttpRequest;return new n}if(t&&"undefined"!=typeof XDomainRequest&&!exports.ua.hasCORS)return new XDomainRequest;try{if("undefined"!=typeof n&&(!t||exports.ua.hasCORS))return new n}catch(r){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(r){}};var re=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];exports.parseUri=function(e){var t=re.exec(e||""),n={},r=14;while(r--)n[parts[r]]=t[r]||"";return n},exports.qs=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=n+"="+encodeURIComponent(e[n]));return t};