function instrument(e){function i(){var e;return this[0].start&&r.indexOf(this)<0&&(r.push(this),e=["splice",[["stat",["call",["name","trace"],[["string",this[0].toString()],["num",this[0].start.line],["num",this[0].start.col],["num",this[0].end.line],["num",this[0].end.col]]]],n.walk(this)]],r.pop(this)),e}var t=jsp.parse(e,!1,!0),n=pro.ast_walker(),r=[],s=n.with_walkers({stat:i,label:i,"break":i,"continue":i,"debugger":i,"var":i,"const":i,"return":i,"throw":i,"try":i,defun:i,"if":i,"while":i,"do":i,"for":i,"for-in":i,"switch":i,"with":i},function(){return n.walk(t)});return pro.gen_code(s,{beautify:!0})}function test(){a=5,c+=a+b,"foo";var e=5;const t=6,n=7;switch("foo"){case"foo":return 1;case"bar":return 2}for(var r=0;r<5;++r)console.log("Hello "+r);for(var r in[1,2,3])console.log(r);for(var r=0;r<5;++r)console.log("foo")}var jsp=require("uglify-js").parser,pro=require("uglify-js").uglify,code=instrument(test.toString());console.log(code);