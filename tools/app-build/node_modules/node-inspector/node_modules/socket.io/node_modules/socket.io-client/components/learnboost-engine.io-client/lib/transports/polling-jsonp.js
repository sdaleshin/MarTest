function empty(){}function JSONPPolling(e){Polling.call(this,e),callbacks||(global.___eio||(global.___eio=[]),callbacks=global.___eio),this.index=callbacks.length;var t=this;callbacks.push(function(e){t.onData(e)}),this.query.j=this.index}var Polling=require("./polling"),util=require("../util");module.exports=JSONPPolling;var global="undefined"!=typeof window?window:global,rNewline=/\n/g,callbacks,index=0;util.inherits(JSONPPolling,Polling),JSONPPolling.prototype.doOpen=function(){var e=this;util.defer(function(){Polling.prototype.doOpen.call(e)})},JSONPPolling.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null),Polling.prototype.doClose.call(this)},JSONPPolling.prototype.doPoll=function(){var e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri();var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),this.script=e,util.ua.gecko&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},JSONPPolling.prototype.doWrite=function(e,t){function u(){a(),t()}function a(){n.iframe&&n.form.removeChild(n.iframe);try{o=document.createElement('<iframe name="'+n.iframeId+'">')}catch(e){o=document.createElement("iframe"),o.name=n.iframeId}o.id=n.iframeId,n.form.appendChild(o),n.iframe=o}var n=this;if(!this.form){var r=document.createElement("form"),i=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index,o;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=s,r.method="POST",r.setAttribute("accept-charset","utf-8"),i.name="d",r.appendChild(i),document.body.appendChild(r),this.form=r,this.area=i}this.form.action=this.uri(),a(),this.area.value=e.replace(rNewline,"\\n");try{this.form.submit()}catch(f){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){n.iframe.readyState=="complete"&&u()}:this.iframe.onload=u};