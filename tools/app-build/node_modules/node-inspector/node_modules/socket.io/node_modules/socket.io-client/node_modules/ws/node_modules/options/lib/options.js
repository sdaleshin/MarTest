/*!
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

function Options(e){var t={},n=this.value={};Object.keys(e).forEach(function(r){t[r]=e[r],Object.defineProperty(n,r,{get:function(){return t[r]},configurable:!1,enumerable:!0})}),this.reset=function(){return Object.keys(e).forEach(function(n){t[n]=e[n]}),this},this.merge=function(e,n){e=e||{};if(Object.prototype.toString.call(n)==="[object Array]"){var r=[];for(var i=0,s=n.length;i<s;++i){var o=n[i];o in e||r.push(o)}if(r.length>0)throw r.length>1?new Error("options "+r.slice(0,r.length-1).join(", ")+" and "+r[r.length-1]+" must be defined"):new Error("option "+r[0]+" must be defined")}return Object.keys(e).forEach(function(n){n in t&&(t[n]=e[n])}),this},this.copy=function(t){var r={};return Object.keys(e).forEach(function(e){t.indexOf(e)!==-1&&(r[e]=n[e])}),r},this.read=function(e,t){if(typeof t=="function"){var n=this;fs.readFile(e,function(e,r){if(e)return t(e);var i=JSON.parse(r);n.merge(i),t()})}else{var r=JSON.parse(fs.readFileSync(e));this.merge(r)}return this},this.isDefined=function(e){return typeof n[e]!="undefined"},this.isDefinedAndNonNull=function(e){return typeof n[e]!="undefined"&&n[e]!==null},Object.freeze(n),Object.freeze(this)}var fs=require("fs");module.exports=Options;