/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

function BufferPool(e,t,n){typeof e=="function"?(n=t,t=e,e=0):typeof e=="undefined"&&(e=0),this._growStrategy=(t||function(e,t){return e.used+t}).bind(null,this),this._shrinkStrategy=(n||function(t){return e}).bind(null,this),this._buffer=e?new Buffer(e):null,this._offset=0,this._used=0,this._changeFactor=0,this.__defineGetter__("size",function(){return this._buffer==null?0:this._buffer.length}),this.__defineGetter__("used",function(){return this._used})}var util=require("util");BufferPool.prototype.get=function(e){if(this._buffer==null||this._offset+e>this._buffer.length){var t=new Buffer(this._growStrategy(e));this._buffer=t,this._offset=0}this._used+=e;var n=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,n},BufferPool.prototype.reset=function(e){var t=this._shrinkStrategy();t<this.size&&(this._changeFactor-=1);if(e||this._changeFactor<-2)this._changeFactor=0,this._buffer=t?new Buffer(t):null;this._offset=0,this._used=0},module.exports=BufferPool;