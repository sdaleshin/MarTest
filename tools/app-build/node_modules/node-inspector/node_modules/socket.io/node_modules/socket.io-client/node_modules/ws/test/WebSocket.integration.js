function getArrayBuffer(e){var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n);for(var i=0;i<t;i++)r[i]=e[i];return r.buffer}function areArraysEqual(e,t){if(e.length!=t.length)return!1;for(var n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}var assert=require("assert"),WebSocket=require("../"),server=require("./testserver"),port=2e4;describe("WebSocket",function(){it("communicates successfully with echo service",function(e){var t=new WebSocket("ws://echo.websocket.org/",{protocolVersion:13,origin:"http://websocket.org"}),n=Date.now().toString(),r=!1;t.on("open",function(){t.send(n,{mask:!0})}),t.on("close",function(){assert.equal(!0,r),e()}),t.on("message",function(e,i){assert.equal(n,e),t.terminate(),r=!0})})});