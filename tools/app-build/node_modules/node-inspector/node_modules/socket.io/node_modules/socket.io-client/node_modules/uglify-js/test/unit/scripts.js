function compress(e){var t=jsp.parse(e);return t=pro.ast_mangle(t),t=pro.ast_squeeze(t,{no_warnings:!0}),t=pro.ast_squeeze_more(t),pro.gen_code(t)}function getTester(e){return function(t){var n=path.join(testDir,e),r=path.join(expectedDir,e),i=fs.readFileSync(n,"utf-8"),s=compress(i);t.ok(i.length>=s.length);var o=compress(i);t.equal(s,o);var u=fs.readFileSync(r,"utf-8");t.equal(s,u.replace(/(\r?\n)+$/,"")),t.done()}}var fs=require("fs"),uglify=require("../../uglify-js"),jsp=uglify.parser,nodeunit=require("nodeunit"),path=require("path"),pro=uglify.uglify,Script=process.binding("evals").Script,scriptsPath=__dirname,testDir=path.join(scriptsPath,"compress","test"),expectedDir=path.join(scriptsPath,"compress","expected"),tests={},scripts=fs.readdirSync(testDir);for(var i in scripts){var script=scripts[i];/\.js$/.test(script)&&(tests[script]=getTester(script))}module.exports=nodeunit.testCase(tests);