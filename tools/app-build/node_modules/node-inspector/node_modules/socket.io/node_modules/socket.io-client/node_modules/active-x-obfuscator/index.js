function ActiveXObfuscator(e){if(!(this instanceof ActiveXObfuscator)){var t=new ActiveXObfuscator(e);return t.execute(),t.toString()}this._parser=ZeParser.createParser(e)}var ZeParser=require("zeparser").ZeParser,Util=require("util");module.exports=ActiveXObfuscator;var OBFUSCATED_ACTIVE_X_OBJECT=ActiveXObfuscator.OBFUSCATED_ACTIVE_X_OBJECT="(['Active'].concat('Object').join('X'))",OBFUSCATED_ACTIVE_X=ActiveXObfuscator.OBFUSCATED_ACTIVE_X="(['Active'].concat('').join('X'))";ActiveXObfuscator.prototype.execute=function(){this._parser.tokenizer.fixValues(),this._obfuscate(this.getAst())},ActiveXObfuscator.prototype.getAst=function(){return this._parser.stack},ActiveXObfuscator.prototype.getWhiteTokens=function(){return this._parser.tokenizer.wtree},ActiveXObfuscator.prototype._obfuscate=function(e){var t=this;e.forEach(function(n,r){if(Array.isArray(n)){t._obfuscate(n);return}switch(n.value){case"ActiveXObject":if(!n.isPropertyName){n.value="window["+OBFUSCATED_ACTIVE_X_OBJECT+"]";break}var i=e[r-1],s=t.getWhiteTokens();s[i.tokposw].value="",n.value="["+OBFUSCATED_ACTIVE_X_OBJECT+"]";break;case"'ActiveXObject'":case'"ActiveXObject"':n.value=OBFUSCATED_ACTIVE_X_OBJECT;break;case"'ActiveX'":case'"ActiveX"':n.value=OBFUSCATED_ACTIVE_X;break;default:if(!/ActiveX/i.test(n.value))break;if(!n.isComment)throw new Error("Unknown ActiveX occurence in: "+Util.inspect(n));n.value=n.value.replace(/ActiveX/i,"Ac...eX")}})},ActiveXObfuscator.prototype.toString=function(){var e=this.getWhiteTokens();return e.reduce(function(e,t){return e+=t.value},"")};