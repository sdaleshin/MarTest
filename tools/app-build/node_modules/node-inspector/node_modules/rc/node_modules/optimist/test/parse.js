var optimist=require("../index"),path=require("path"),test=require("tap").test,$0="node ./"+path.relative(process.cwd(),__filename);test("short boolean",function(e){var t=optimist.parse(["-b"]);e.same(t,{b:!0,_:[],$0:$0}),e.same(typeof t.b,"boolean"),e.end()}),test("long boolean",function(e){e.same(optimist.parse(["--bool"]),{bool:!0,_:[],$0:$0}),e.end()}),test("bare",function(e){e.same(optimist.parse(["foo","bar","baz"]),{_:["foo","bar","baz"],$0:$0}),e.end()}),test("short group",function(e){e.same(optimist.parse(["-cats"]),{c:!0,a:!0,t:!0,s:!0,_:[],$0:$0}),e.end()}),test("short group next",function(e){e.same(optimist.parse(["-cats","meow"]),{c:!0,a:!0,t:!0,s:"meow",_:[],$0:$0}),e.end()}),test("short capture",function(e){e.same(optimist.parse(["-h","localhost"]),{h:"localhost",_:[],$0:$0}),e.end()}),test("short captures",function(e){e.same(optimist.parse(["-h","localhost","-p","555"]),{h:"localhost",p:555,_:[],$0:$0}),e.end()}),test("long capture sp",function(e){e.same(optimist.parse(["--pow","xixxle"]),{pow:"xixxle",_:[],$0:$0}),e.end()}),test("long capture eq",function(e){e.same(optimist.parse(["--pow=xixxle"]),{pow:"xixxle",_:[],$0:$0}),e.end()}),test("long captures sp",function(e){e.same(optimist.parse(["--host","localhost","--port","555"]),{host:"localhost",port:555,_:[],$0:$0}),e.end()}),test("long captures eq",function(e){e.same(optimist.parse(["--host=localhost","--port=555"]),{host:"localhost",port:555,_:[],$0:$0}),e.end()}),test("mixed short bool and capture",function(e){e.same(optimist.parse(["-h","localhost","-fp","555","script.js"]),{f:!0,p:555,h:"localhost",_:["script.js"],$0:$0}),e.end()}),test("short and long",function(e){e.same(optimist.parse(["-h","localhost","-fp","555","script.js"]),{f:!0,p:555,h:"localhost",_:["script.js"],$0:$0}),e.end()}),test("no",function(e){e.same(optimist.parse(["--no-moo"]),{moo:!1,_:[],$0:$0}),e.end()}),test("multi",function(e){e.same(optimist.parse(["-v","a","-v","b","-v","c"]),{v:["a","b","c"],_:[],$0:$0}),e.end()}),test("comprehensive",function(e){e.same(optimist.parse(["--name=meowmers","bare","-cats","woo","-h","awesome","--multi=quux","--key","value","-b","--bool","--no-meep","--multi=baz","--","--not-a-flag","eek"]),{c:!0,a:!0,t:!0,s:"woo",h:"awesome",b:!0,bool:!0,key:"value",multi:["quux","baz"],meep:!1,name:"meowmers",_:["bare","--not-a-flag","eek"],$0:$0}),e.end()}),test("nums",function(e){var t=optimist.parse(["-x","1234","-y","5.67","-z","1e7","-w","10f","--hex","0xdeadbeef","789"]);e.same(t,{x:1234,y:5.67,z:1e7,w:"10f",hex:3735928559,_:[789],$0:$0}),e.same(typeof t.x,"number"),e.same(typeof t.y,"number"),e.same(typeof t.z,"number"),e.same(typeof t.w,"string"),e.same(typeof t.hex,"number"),e.same(typeof t._[0],"number"),e.end()}),test("flag boolean",function(e){var t=optimist(["-t","moo"]).boolean(["t"]).argv;e.same(t,{t:!0,_:["moo"],$0:$0}),e.same(typeof t.t,"boolean"),e.end()}),test("flag boolean value",function(e){var t=optimist(["--verbose","false","moo","-t","true"]).boolean(["t","verbose"]).default("verbose",!0).argv;e.same(t,{verbose:!1,t:!0,_:["moo"],$0:$0}),e.same(typeof t.verbose,"boolean"),e.same(typeof t.t,"boolean"),e.end()}),test("flag boolean default false",function(e){var t=optimist(["moo"]).boolean(["t","verbose"]).default("verbose",!1).default("t",!1).argv;e.same(t,{verbose:!1,t:!1,_:["moo"],$0:$0}),e.same(typeof t.verbose,"boolean"),e.same(typeof t.t,"boolean"),e.end()}),test("boolean groups",function(e){var t=optimist(["-x","-z","one","two","three"]).boolean(["x","y","z"]).argv;e.same(t,{x:!0,y:!1,z:!0,_:["one","two","three"],$0:$0}),e.same(typeof t.x,"boolean"),e.same(typeof t.y,"boolean"),e.same(typeof t.z,"boolean"),e.end()}),test("newlines in params",function(e){var t=optimist.parse(["-s","X\nX"]);e.same(t,{_:[],s:"X\nX",$0:$0}),t=optimist.parse(["--s=X\nX"]),e.same(t,{_:[],s:"X\nX",$0:$0}),e.end()}),test("strings",function(e){var t=optimist(["-s","0001234"]).string("s").argv.s;e.same(t,"0001234"),e.same(typeof t,"string");var n=optimist(["-x","56"]).string("x").argv.x;e.same(n,"56"),e.same(typeof n,"string"),e.end()}),test("stringArgs",function(e){var t=optimist(["  ","  "]).string("_").argv._;e.same(t.length,2),e.same(typeof t[0],"string"),e.same(t[0],"  "),e.same(typeof t[1],"string"),e.same(t[1],"  "),e.end()}),test("slashBreak",function(e){e.same(optimist.parse(["-I/foo/bar/baz"]),{I:"/foo/bar/baz",_:[],$0:$0}),e.same(optimist.parse(["-xyz/foo/bar/baz"]),{x:!0,y:!0,z:"/foo/bar/baz",_:[],$0:$0}),e.end()}),test("alias",function(e){var t=optimist(["-f","11","--zoom","55"]).alias("z","zoom").argv;e.equal(t.zoom,55),e.equal(t.z,t.zoom),e.equal(t.f,11),e.end()}),test("multiAlias",function(e){var t=optimist(["-f","11","--zoom","55"]).alias("z",["zm","zoom"]).argv;e.equal(t.zoom,55),e.equal(t.z,t.zoom),e.equal(t.z,t.zm),e.equal(t.f,11),e.end()}),test("boolean default true",function(e){var t=optimist.options({sometrue:{"boolean":!0,"default":!0}}).argv;e.equal(t.sometrue,!0),e.end()}),test("boolean default false",function(e){var t=optimist.options({somefalse:{"boolean":!0,"default":!1}}).argv;e.equal(t.somefalse,!1),e.end()}),test("nested dotted objects",function(e){var t=optimist(["--foo.bar","3","--foo.baz","4","--foo.quux.quibble","5","--foo.quux.o_O","--beep.boop"]).argv;e.same(t.foo,{bar:3,baz:4,quux:{quibble:5,o_O:!0}}),e.same(t.beep,{boop:!0}),e.end()}),test("boolean and alias with chainable api",function(e){var t=["-h","derp"],n=["--herp","derp"],r={herp:{alias:"h","boolean":!0}},i=optimist(t).boolean("herp").alias("h","herp").argv,s=optimist(n).boolean("herp").alias("h","herp").argv,o={herp:!0,h:!0,_:["derp"],$0:$0};e.same(i,o),e.same(s,o),e.end()}),test("boolean and alias with options hash",function(e){var t=["-h","derp"],n=["--herp","derp"],r={herp:{alias:"h","boolean":!0}},i=optimist(t).options(r).argv,s=optimist(n).options(r).argv,o={herp:!0,h:!0,_:["derp"],$0:$0};e.same(i,o),e.same(s,o),e.end()}),test("boolean and alias using explicit true",function(e){var t=["-h","true"],n=["--herp","true"],r={herp:{alias:"h","boolean":!0}},i=optimist(t).boolean("h").alias("h","herp").argv,s=optimist(n).boolean("h").alias("h","herp").argv,o={herp:!0,h:!0,_:[],$0:$0};e.same(i,o),e.same(s,o),e.end()}),test("boolean and --x=true",function(e){var t=optimist(["--boool","--other=true"]).boolean("boool").argv;e.same(t.boool,!0),e.same(t.other,"true"),t=optimist(["--boool","--other=false"]).boolean("boool").argv,e.same(t.boool,!0),e.same(t.other,"false"),e.end()});