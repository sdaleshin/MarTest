function glob(e,t,n){typeof t=="function"&&(n=t,t={}),t||(t={});if(typeof t=="number"){deprecated();return}var r=new Glob(e,t,n);return r.sync?r.found:r}function deprecated(){throw new Error("glob's interface has changed. Please see the docs.")}function globSync(e,t){if(typeof t=="number"){deprecated();return}return t=t||{},t.sync=!0,glob(e,t)}function Glob(e,t,n){function o(e,t,n){this._process(e,0,t,function(e){e&&this.emit("error",e),--s<=0&&this._finish()})}if(!(this instanceof Glob))return new Glob(e,t,n);typeof t=="function"&&(n=t,t=null),typeof n=="function"&&(this.on("error",n),this.on("end",function(e){n(null,e)})),t=t||{},this.EOF={},this._emitQueue=[],this.maxDepth=t.maxDepth||1e3,this.maxLength=t.maxLength||Infinity,this.cache=t.cache||{},this.statCache=t.statCache||{},this.changedCwd=!1;var r=process.cwd();t.hasOwnProperty("cwd")?(this.cwd=t.cwd,this.changedCwd=path.resolve(t.cwd)!==r):this.cwd=r,this.root=t.root||path.resolve(this.cwd,"/"),this.root=path.resolve(this.root),process.platform==="win32"&&(this.root=this.root.replace(/\\/g,"/")),this.nomount=!!t.nomount;if(!e)throw new Error("must provide pattern");if(t.matchBase&&-1===e.indexOf("/")){if(t.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}this.strict=t.strict!==!1,this.dot=!!t.dot,this.mark=!!t.mark,this.sync=!!t.sync,this.nounique=!!t.nounique,this.nonull=!!t.nonull,this.nosort=!!t.nosort,this.nocase=!!t.nocase,this.stat=!!t.stat,this.debug=!!t.debug||!!t.globDebug,this.debug&&(this.log=console.error),this.silent=!!t.silent;var i=this.minimatch=new Minimatch(e,t);this.options=i.options,e=this.pattern=i.pattern,this.error=null,this.aborted=!1,this._globstars={},EE.call(this);var s=this.minimatch.set.length;this.matches=new Array(s),this.minimatch.set.forEach(o.bind(this))}function alphasorti(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),alphasort(e,t)}function alphasort(e,t){return e>t?1:e<t?-1:0}function gsKey(e){return"**"+e.map(function(e){return e===minimatch.GLOBSTAR?"**":""+e}).join("/")}function absWin(e){if(absUnix(e))return!0;var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,n=t.exec(e),r=n[1]||"",i=r&&r.charAt(1)!==":",s=!!n[2]||i;return s}function absUnix(e){return e.charAt(0)==="/"||e===""}module.exports=glob;var fs=require("fs"),minimatch=require("minimatch"),Minimatch=minimatch.Minimatch,inherits=require("inherits"),EE=require("events").EventEmitter,path=require("path"),isDir={},assert=require("assert").ok;glob.fnmatch=deprecated,glob.sync=globSync,glob.Glob=Glob,inherits(Glob,EE),Glob.prototype.log=function(){},Glob.prototype._finish=function(){assert(this instanceof Glob);var e=this.nounique,t=e?[]:{};for(var n=0,r=this.matches.length;n<r;n++){var i=this.matches[n];this.log("matches[%d] =",n,i);if(!i){if(this.nonull){var s=this.minimatch.globSet[n];e?t.push(s):t[s]=!0}}else{var o=Object.keys(i);e?t.push.apply(t,o):o.forEach(function(e){t[e]=!0})}}e||(t=Object.keys(t)),this.nosort||(t=t.sort(this.nocase?alphasorti:alphasort)),this.mark&&(t=t.map(function(e){var t=this.cache[e];if(!t)return e;var n=Array.isArray(t)||t===2;return n&&e.slice(-1)!=="/"?e+"/":!n&&e.slice(-1)==="/"?e.replace(/\/+$/,""):e},this)),this.log("emitting end",t),this.EOF=this.found=t,this.emitMatch(this.EOF)},Glob.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Glob.prototype.pause=function(){if(this.paused)return;this.sync&&this.emit("error",new Error("Can't pause/resume sync glob")),this.paused=!0,this.emit("pause")},Glob.prototype.resume=function(){if(!this.paused)return;this.sync&&this.emit("error",new Error("Can't pause/resume sync glob")),this.paused=!1,this.emit("resume"),this._processEmitQueue()},Glob.prototype.emitMatch=function(e){!this.stat||this.statCache[e]||e===this.EOF?(this._emitQueue.push(e),this._processEmitQueue()):this._stat(e,function(t,n){t&&(this._emitQueue.push(e),this._processEmitQueue())})},Glob.prototype._processEmitQueue=function(e){while(!this._processingEmitQueue&&!this.paused){this._processingEmitQueue=!0;var e=this._emitQueue.shift();if(!e){this._processingEmitQueue=!1;break}this.log("emit!",e===this.EOF?"end":"match"),this.emit(e===this.EOF?"end":"match",e),this._processingEmitQueue=!1}},Glob.prototype._process=function(e,t,n,r){assert(this instanceof Glob);var i=function(t,n){assert(this instanceof Glob),this.paused?(this._processQueue||(this._processQueue=[],this.once("resume",function(){var e=this._processQueue;this._processQueue=null,e.forEach(function(e){e()})})),this._processQueue.push(r.bind(this,t,n))):r.call(this,t,n)}.bind(this);if(this.aborted)return i();if(t>this.maxDepth)return i();var s=0;while(typeof e[s]=="string")s++;var o;switch(s){case e.length:o=e.join("/"),this._stat(o,function(e,t){return e&&(o&&isAbsolute(o)&&!this.nomount&&(o.charAt(0)==="/"?o=path.join(this.root,o):o=path.resolve(this.root,o)),process.platform==="win32"&&(o=o.replace(/\\/g,"/")),this.matches[n]=this.matches[n]||{},this.matches[n][o]=!0,this.emitMatch(o)),i()});return;case 0:o=null;break;default:o=e.slice(0,s),o=o.join("/")}var u;if(o===null)u=".";else if(isAbsolute(o)||isAbsolute(e.join("/"))){if(!o||!isAbsolute(o))o=path.join("/",o);u=o=path.resolve(o),this.log("absolute: ",o,this.root,e,u)}else u=o;return this.log("readdir(%j)",u,this.cwd,this.root),this._readdir(u,function(r,u){if(r)return i();if(e[s]===minimatch.GLOBSTAR){var a=[e.slice(0,s).concat(e.slice(s+1))];u.forEach(function(t){if(t.charAt(0)==="."&&!this.dot)return;a.push(e.slice(0,s).concat(t).concat(e.slice(s+1))),a.push(e.slice(0,s).concat(t).concat(e.slice(s)))},this),a=a.filter(function(e){var t=gsKey(e),n=!this._globstars[t];return this._globstars[t]=!0,n},this);if(!a.length)return i();var f=a.length,l=null;a.forEach(function(e){this._process(e,t+1,n,function(e){if(l)return;if(e)return i(l=e);if(--f<=0)return i()})},this);return}var c=e[s],h=e[s]._glob,p=this.dot||h.charAt(0)===".";u=u.filter(function(t){return(t.charAt(0)!=="."||p)&&t.match(e[s])});if(s===e.length-1&&!this.mark&&!this.stat)return u.forEach(function(e){o&&(o!=="/"?e=o+"/"+e:e=o+e),e.charAt(0)==="/"&&!this.nomount&&(e=path.join(this.root,e)),process.platform==="win32"&&(e=e.replace(/\\/g,"/")),this.matches[n]=this.matches[n]||{},this.matches[n][e]=!0,this.emitMatch(e)},this),i.call(this);var f=u.length,l=null;if(f===0)return i();u.forEach(function(r){var o=e.slice(0,s).concat(r).concat(e.slice(s+1));this._process(o,t+1,n,function(e){if(l)return;if(e)return i(l=e);if(--f===0)return i.call(this)})},this)})},Glob.prototype._stat=function(e,t){assert(this instanceof Glob);var n=e;e.charAt(0)==="/"?n=path.join(this.root,e):this.changedCwd&&(n=path.resolve(this.cwd,e));if(e.length>this.maxLength){var r=new Error("Path name too long");return r.code="ENAMETOOLONG",r.path=e,this._afterStat(e,n,t,r)}this.log("stat",[this.cwd,e,"=",n]);if(!this.stat&&this.cache.hasOwnProperty(e)){var i=this.cache[e],s=i&&(Array.isArray(i)||i===2);return this.sync?t.call(this,!!i,s):process.nextTick(t.bind(this,!!i,s))}var o=this.statCache[n];if(this.sync||o){var r;try{o=fs.statSync(n)}catch(u){r=u}this._afterStat(e,n,t,r,o)}else fs.stat(n,this._afterStat.bind(this,e,n,t))},Glob.prototype._afterStat=function(e,t,n,r,i){var s;assert(this instanceof Glob),t.slice(-1)==="/"&&i&&!i.isDirectory()&&(this.log("should be ENOTDIR, fake it"),r=new Error("ENOTDIR, not a directory '"+t+"'"),r.path=t,r.code="ENOTDIR",i=null);var o=!this.statCache[t];this.statCache[t]=i,r||!i?s=!1:(s=i.isDirectory()?2:1,o&&this.emit("stat",e,i)),this.cache[e]=this.cache[e]||s,n.call(this,!!s,s===2)},Glob.prototype._readdir=function(e,t){assert(this instanceof Glob);var n=e;e.charAt(0)==="/"?n=path.join(this.root,e):isAbsolute(e)?n=e:this.changedCwd&&(n=path.resolve(this.cwd,e));if(e.length>this.maxLength){var r=new Error("Path name too long");return r.code="ENAMETOOLONG",r.path=e,this._afterReaddir(e,n,t,r)}this.log("readdir",[this.cwd,e,n]);if(this.cache.hasOwnProperty(e)){var i=this.cache[e];if(Array.isArray(i))return this.sync?t.call(this,null,i):process.nextTick(t.bind(this,null,i));if(!i||i===1){var s=i?"ENOTDIR":"ENOENT",r=new Error((i?"Not a directory":"Not found")+": "+e);return r.path=e,r.code=s,this.log(e,r),this.sync?t.call(this,r):process.nextTick(t.bind(this,r))}}if(this.sync){var r,o;try{o=fs.readdirSync(n)}catch(u){r=u}return this._afterReaddir(e,n,t,r,o)}fs.readdir(n,this._afterReaddir.bind(this,e,n,t))},Glob.prototype._afterReaddir=function(e,t,n,r,i){assert(this instanceof Glob);if(i&&!r)return this.cache[e]=i,!this.mark&&!this.stat&&i.forEach(function(t){e==="/"?t=e+t:t=e+"/"+t,this.cache[t]=!0},this),n.call(this,r,i);if(r)switch(r.code){case"ENOTDIR":return this.cache[e]=1,n.call(this,r);case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":return this.cache[e]=!1,n.call(this,r);default:return this.cache[e]=!1,this.strict&&this.emit("error",r),this.silent||console.error("glob error",r),n.call(this,r)}};var isAbsolute=process.platform==="win32"?absWin:absUnix;