function alphasort(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),e>t?1:e<t?-1:0}function cleanResults(e){return e.map(function(e){return e.replace(/\/+/g,"/").replace(/\/$/,"")}).sort(alphasort).reduce(function(e,t){return t!==e[e.length-1]&&e.push(t),e},[]).sort(alphasort).map(function(e){return process.platform!=="win32"?e:e.replace(/^[a-zA-Z]:\\\\/,"/").replace(/\\/g,"/")})}var tap=require("tap"),child_process=require("child_process"),pattern="test/a/!(symlink)/**",bashResults=require("./bash-results.json"),patterns=Object.keys(bashResults),glob=require("../"),Glob=glob.Glob,path=require("path");process.chdir(path.resolve(__dirname,".."));var globResults=[];tap.test("use a Glob object, and pause/resume it",function(e){var t=new Glob(pattern),n=!1,r=[],i=bashResults[pattern];t.on("pause",function(){console.error("pause")}),t.on("resume",function(){console.error("resume")}),t.on("match",function(n){e.notOk(t.paused,"must not be paused"),globResults.push(n),t.pause(),e.ok(t.paused,"must be paused"),setTimeout(t.resume.bind(t),10)}),t.on("end",function(t){e.pass("reached glob end"),globResults=cleanResults(globResults),t=cleanResults(t),e.deepEqual(t,globResults,"end event matches should be the same as match events"),e.deepEqual(t,i,"glob matches should be the same as bash results"),e.end()})});