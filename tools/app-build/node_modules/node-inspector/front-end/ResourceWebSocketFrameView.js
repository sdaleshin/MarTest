/*
 * Copyright (C) 2012 Research In Motion Limited. All rights reserved.
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 */

WebInspector.ResourceWebSocketFrameView=function(e){WebInspector.View.call(this),this.element.addStyleClass("resource-websocket"),this.resource=e,this.element.removeChildren(),this._dataGrid=new WebInspector.DataGrid([{id:"data",title:WebInspector.UIString("Data"),sortable:!1,weight:88},{id:"length",title:WebInspector.UIString("Length"),sortable:!1,alig:WebInspector.DataGrid.Align.Right,weight:5},{id:"time",title:WebInspector.UIString("Time"),weight:7}]),this.refresh(),this._dataGrid.setName("ResourceWebSocketFrameView"),this._dataGrid.show(this.element)},WebInspector.ResourceWebSocketFrameView.OpCodes={ContinuationFrame:0,TextFrame:1,BinaryFrame:2,ConnectionCloseFrame:8,PingFrame:9,PongFrame:10},WebInspector.ResourceWebSocketFrameView.prototype={appendFrame:function(e){var t=e,n=new Date(t.time*1e3),r={data:"",length:typeof t.payloadData=="undefined"?t.errorMessage.length.toString():t.payloadData.length.toString(),time:n.toLocaleTimeString()},i="";if(t.errorMessage)i="error",r.data=t.errorMessage;else if(t.opcode==WebInspector.ResourceWebSocketFrameView.OpCodes.TextFrame)t.sent&&(i="outcoming"),r.data=t.payloadData;else{i="opcode";var s="";switch(t.opcode){case WebInspector.ResourceWebSocketFrameView.OpCodes.ContinuationFrame:s=WebInspector.UIString("Continuation Frame");break;case WebInspector.ResourceWebSocketFrameView.OpCodes.BinaryFrame:s=WebInspector.UIString("Binary Frame");break;case WebInspector.ResourceWebSocketFrameView.OpCodes.ConnectionCloseFrame:s=WebInspector.UIString("Connection Close Frame");break;case WebInspector.ResourceWebSocketFrameView.OpCodes.PingFrame:s=WebInspector.UIString("Ping Frame");break;case WebInspector.ResourceWebSocketFrameView.OpCodes.PongFrame:s=WebInspector.UIString("Pong Frame")}r.data=WebInspector.UIString("%s (Opcode %d%s)",s,t.opcode,t.mask?", mask":"")}var o=new WebInspector.DataGridNode(r,!1);this._dataGrid.rootNode().appendChild(o),i&&o.element.classList.add("resource-websocket-row-"+i)},refresh:function(){this._dataGrid.rootNode().removeChildren();var e=this.resource.frames();for(var t=e.length-1;t>=0;t--)this.appendFrame(e[t])},show:function(e,t){this.refresh(),WebInspector.View.prototype.show.call(this,e,t)},__proto__:WebInspector.View.prototype};