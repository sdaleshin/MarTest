/*
 * Copyright (C) 2012 Google Inc. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

WebInspector.DirectoryContentView=function(){const e=WebInspector.DirectoryContentView.columnIndexes;var t=[{id:e.Name,title:WebInspector.UIString("Name"),sortable:!0,sort:WebInspector.DataGrid.Order.Ascending,width:"20%"},{id:e.URL,title:WebInspector.UIString("URL"),sortable:!0,width:"20%"},{id:e.Type,title:WebInspector.UIString("Type"),sortable:!0,width:"15%"},{id:e.Size,title:WebInspector.UIString("Size"),sortable:!0,width:"10%"},{id:e.ModificationTime,title:WebInspector.UIString("Modification Time"),sortable:!0,width:"25%"}];WebInspector.DataGrid.call(this,t),this.addEventListener(WebInspector.DataGrid.Events.SortingChanged,this._sort,this)},WebInspector.DirectoryContentView.columnIndexes={Name:"0",URL:"1",Type:"2",Size:"3",ModificationTime:"4"},WebInspector.DirectoryContentView.prototype={showEntries:function(e){const t=WebInspector.DirectoryContentView.columnIndexes;this.rootNode().removeChildren();for(var n=0;n<e.length;++n)this.rootNode().appendChild(new WebInspector.DirectoryContentView.Node(e[n]))},_sort:function(){var e=this.sortColumnIdentifier();this.sortNodes(WebInspector.DirectoryContentView.Node.comparator(e,!this.isSortOrderAscending()),!1)},__proto__:WebInspector.DataGrid.prototype},WebInspector.DirectoryContentView.Node=function(e){const t=WebInspector.DirectoryContentView.columnIndexes;var n={};n[t.Name]=e.name,n[t.URL]=e.url,n[t.Type]=e.isDirectory?WebInspector.UIString("Directory"):e.mimeType,n[t.Size]="",n[t.ModificationTime]="",WebInspector.DataGridNode.call(this,n),this._entry=e,this._metadata=null,this._entry.requestMetadata(this._metadataReceived.bind(this))},WebInspector.DirectoryContentView.Node.comparator=function(e,t){function i(e,t){return e._entry.isDirectory!=t._entry.isDirectory?t._entry.isDirectory?1:-1:0}function s(e,t){return n*e._entry.name.compareTo(t._entry.name)}function o(e,t){return n*(e._entry.mimeType||"").compareTo(t._entry.mimeType||"")}function u(e,t){return n*((e._metadata?e._metadata.size:0)-(t._metadata?t._metadata.size:0))}function a(e,t){return n*((e._metadata?e._metadata.modificationTime:0)-(t._metadata?t._metadata.modificationTime:0))}var n=t?-1:1;const r=WebInspector.DirectoryContentView.columnIndexes;switch(e){case r.Name:case r.URL:return function(e,t){return i(e,t)||s(e,t)};case r.Type:return function(e,t){return i(e,t)||o(e,t)||s(e,t)};case r.Size:return function(e,t){return i(e,t)||u(e,t)||s(e,t)};case r.ModificationTime:return function(e,t){return i(e,t)||a(e,t)||s(e,t)}}},WebInspector.DirectoryContentView.Node.prototype={_metadataReceived:function(e,t){const n=WebInspector.DirectoryContentView.columnIndexes;if(e!==0)return;this._metadata=t;var r=this.data;this._entry.isDirectory?r[n.Size]=WebInspector.UIString("-"):r[n.Size]=Number.bytesToString(t.size),r[n.ModificationTime]=(new Date(t.modificationTime)).toGMTString(),this.data=r},__proto__:WebInspector.DataGridNode.prototype};