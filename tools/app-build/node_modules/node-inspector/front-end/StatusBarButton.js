/*
 * Copyright (C) 2009 Google Inc. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

WebInspector.StatusBarItem=function(e){this.element=e,this._enabled=!0},WebInspector.StatusBarItem.prototype={setEnabled:function(e){if(this._enabled===e)return;this._enabled=e,this._applyEnabledState()},_applyEnabledState:function(){this.element.disabled=!this._enabled},__proto__:WebInspector.Object.prototype},WebInspector.StatusBarText=function(e,t){WebInspector.StatusBarItem.call(this,document.createElement("span")),this.element.className="status-bar-item status-bar-text",t&&this.element.addStyleClass(t),this.element.textContent=e},WebInspector.StatusBarText.prototype={setText:function(e){this.element.textContent=e},__proto__:WebInspector.StatusBarItem.prototype},WebInspector.StatusBarButton=function(e,t,n){WebInspector.StatusBarItem.call(this,document.createElement("button")),this.element.className=t+" status-bar-item",this.element.addEventListener("click",this._clicked.bind(this),!1),this.glyph=document.createElement("div"),this.glyph.className="glyph",this.element.appendChild(this.glyph),this.glyphShadow=document.createElement("div"),this.glyphShadow.className="glyph shadow",this.element.appendChild(this.glyphShadow),this.states=n,n||(this.states=2),n==2?this._state=!1:this._state=0,this.title=e,this.className=t,this._visible=!0},WebInspector.StatusBarButton.prototype={_clicked:function(){this.dispatchEventToListeners("click"),this._longClickInterval&&(clearInterval(this._longClickInterval),delete this._longClickInterval)},_applyEnabledState:function(){this.element.disabled=!this._enabled,this._longClickInterval&&(clearInterval(this._longClickInterval),delete this._longClickInterval)},enabled:function(){return this._enabled},get title(){return this._title},set title(e){if(this._title===e)return;this._title=e,this.element.title=e},get state(){return this._state},set state(e){if(this._state===e)return;this.states===2?this.element.enableStyleClass("toggled-on",e):(this.element.removeStyleClass("toggled-"+this._state),e!==0&&this.element.addStyleClass("toggled-"+e)),this._state=e},get toggled(){if(this.states!==2)throw"Only used toggled when there are 2 states, otherwise, use state";return this.state},set toggled(e){if(this.states!==2)throw"Only used toggled when there are 2 states, otherwise, use state";this.state=e},get visible(){return this._visible},set visible(e){if(this._visible===e)return;this.element.enableStyleClass("hidden",!e),this._visible=e},makeLongClickEnabled:function(){function r(e){if(e.which!==1)return;n=0,this._longClickInterval=setInterval(s.bind(this),200)}function i(e){if(e.which!==1)return;this._longClickInterval&&(clearInterval(this._longClickInterval),delete this._longClickInterval)}function s(){++n,this.dispatchEventToListeners(n===1?"longClickDown":"longClickPress")}var e=r.bind(this),t=i.bind(this);this.element.addEventListener("mousedown",e,!1),this.element.addEventListener("mouseout",t,!1),this.element.addEventListener("mouseup",t,!1);var n=0;this._longClickData={mouseUp:t,mouseDown:e}},unmakeLongClickEnabled:function(){if(!this._longClickData)return;this.element.removeEventListener("mousedown",this._longClickData.mouseDown,!1),this.element.removeEventListener("mouseout",this._longClickData.mouseUp,!1),this.element.removeEventListener("mouseup",this._longClickData.mouseUp,!1),delete this._longClickData},setLongClickOptionsEnabled:function(e){if(e){if(!this._longClickOptionsData){this.makeLongClickEnabled(),this.longClickGlyph=document.createElement("div"),this.longClickGlyph.className="fill long-click-glyph",this.element.appendChild(this.longClickGlyph),this.longClickGlyphShadow=document.createElement("div"),this.longClickGlyphShadow.className="fill long-click-glyph shadow",this.element.appendChild(this.longClickGlyphShadow);var t=this._showOptions.bind(this);this.addEventListener("longClickDown",t,this),this._longClickOptionsData={glyphElement:this.longClickGlyph,glyphShadowElement:this.longClickGlyphShadow,longClickDownListener:t}}this._longClickOptionsData.buttonsProvider=e}else{if(!this._longClickOptionsData)return;this.element.removeChild(this._longClickOptionsData.glyphElement),this.element.removeChild(this._longClickOptionsData.glyphShadowElement),this.removeEventListener("longClickDown",this._longClickOptionsData.longClickDownListener,this),delete this._longClickOptionsData,this.unmakeLongClickEnabled()}},_showOptions:function(){function h(e){if(e.which!==1)return;var t=e.target.enclosingNodeOrSelfWithClass("status-bar-item");t.addStyleClass("emulate-active")}function p(e){if(e.which!==1)return;var t=e.target.enclosingNodeOrSelfWithClass("status-bar-item");t.removeStyleClass("emulate-active")}function d(t){if(t.which!==1)return;r.dispose(),document.documentElement.removeEventListener("mouseup",n,!1);for(var i=0;i<e.length;++i)if(e[i].element.hasStyleClass("emulate-active")){e[i].element.removeStyleClass("emulate-active"),e[i]._clicked();break}}var e=this._longClickOptionsData.buttonsProvider(),t=new WebInspector.StatusBarButton(this.title,this.className,this.states);t.addEventListener("click",this._clicked,this),t.state=this.state,e.push(t);var n=d.bind(this);document.documentElement.addEventListener("mouseup",n,!1);var r=new WebInspector.GlassPane,i=r.element.createChild("div","alternate-status-bar-buttons-bar");const s=23;var o=this.element.totalOffset(),u=o.top<document.documentElement.offsetHeight/2;u&&(e=e.reverse()),i.style.height=s*e.length+"px",u?i.style.top=o.top+1+"px":i.style.top=o.top-s*(e.length-1)+"px",i.style.left=o.left+1+"px";var a=h.bind(this),f=p.bind(this);for(var l=0;l<e.length;++l)e[l].element.addEventListener("mousemove",a,!1),e[l].element.addEventListener("mouseout",f,!1),i.appendChild(e[l].element);var c=u?0:e.length-1;e[c].element.addStyleClass("emulate-active")},__proto__:WebInspector.StatusBarItem.prototype},WebInspector.StatusBarComboBox=function(e,t){WebInspector.StatusBarItem.call(this,document.createElement("span")),this.element.className="status-bar-select-container",this._selectElement=this.element.createChild("select","status-bar-item"),this.element.createChild("div","status-bar-select-arrow"),e&&this._selectElement.addEventListener("change",e,!1),t&&this._selectElement.addStyleClass(t)},WebInspector.StatusBarComboBox.prototype={selectElement:function(){return this._selectElement},size:function(){return this._selectElement.childElementCount},addOption:function(e){this._selectElement.appendChild(e)},createOption:function(e,t,n){var r=this._selectElement.createChild("option");return r.text=e,t&&(r.title=t),typeof n!="undefined"&&(r.value=n),r},_applyEnabledState:function(){this._selectElement.disabled=!this._enabled},removeOption:function(e){this._selectElement.removeChild(e)},removeOptions:function(){this._selectElement.removeChildren()},selectedOption:function(){return this._selectElement.selectedIndex>=0?this._selectElement[this._selectElement.selectedIndex]:null},select:function(e){this._selectElement.selectedIndex=Array.prototype.indexOf.call(this._selectElement,e)},setSelectedIndex:function(e){this._selectElement.selectedIndex=e},selectedIndex:function(){return this._selectElement.selectedIndex},__proto__:WebInspector.StatusBarItem.prototype};