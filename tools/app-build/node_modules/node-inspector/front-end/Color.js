/*
 * Copyright (C) 2009 Apple Inc.  All rights reserved.
 * Copyright (C) 2009 Joseph Pecoraro
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1.  Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 * 2.  Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 * 3.  Neither the name of Apple Computer, Inc. ("Apple") nor the names of
 *     its contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

WebInspector.Color=function(e,t,n){this._rgba=e,this._originalText=n||null,this._format=t||null,typeof this._rgba[3]=="undefined"&&(this._rgba[3]=1);for(var r=0;r<4;++r)this._rgba[r]<0&&(this._rgba[r]=0),this._rgba[r]>1&&(this._rgba[r]=1)},WebInspector.Color.parse=function(e){var t=e.toLowerCase().replace(/\s+/g,""),n=/^(?:#([0-9a-f]{3,6})|rgb\(([^)]+)\)|(\w+)|hsl\(([^)]+)\))$/i,r=t.match(n);if(r){if(r[1]){var i=r[1].toUpperCase(),s;i.length===3?(s=WebInspector.Color.Format.ShortHEX,i=i.charAt(0)+i.charAt(0)+i.charAt(1)+i.charAt(1)+i.charAt(2)+i.charAt(2)):s=WebInspector.Color.Format.HEX;var o=parseInt(i.substring(0,2),16),u=parseInt(i.substring(2,4),16),a=parseInt(i.substring(4,6),16);return new WebInspector.Color([o/255,u/255,a/255,1],s,e)}if(r[2]){var f=r[2].split(/\s*,\s*/),l=[WebInspector.Color._parseRgbNumeric(f[0]),WebInspector.Color._parseRgbNumeric(f[1]),WebInspector.Color._parseRgbNumeric(f[2]),1];return new WebInspector.Color(l,WebInspector.Color.Format.RGB,e)}if(r[3]){var c=r[3].toLowerCase();if(c in WebInspector.Color.Nicknames){var l=WebInspector.Color.Nicknames[c],h=WebInspector.Color.fromRGBA(l);return h._format=WebInspector.Color.Format.Nickname,h._originalText=c,h}return null}if(r[4]){var p=r[4].replace(/%/g,"").split(/\s*,\s*/),d=[WebInspector.Color._parseHueNumeric(p[0]),WebInspector.Color._parseSatLightNumeric(p[1]),WebInspector.Color._parseSatLightNumeric(p[2]),1],l=WebInspector.Color._hsl2rgb(d);return new WebInspector.Color(l,WebInspector.Color.Format.HSL,e)}return null}var v=/^(?:rgba\(([^)]+)\)|hsla\(([^)]+)\))$/;r=t.match(v);if(r){if(r[1]){var m=r[1].split(/\s*,\s*/),l=[WebInspector.Color._parseRgbNumeric(m[0]),WebInspector.Color._parseRgbNumeric(m[1]),WebInspector.Color._parseRgbNumeric(m[2]),WebInspector.Color._parseAlphaNumeric(m[3])];return new WebInspector.Color(l,WebInspector.Color.Format.RGBA,e)}if(r[2]){var g=r[2].replace(/%/g,"").split(/\s*,\s*/),d=[WebInspector.Color._parseHueNumeric(g[0]),WebInspector.Color._parseSatLightNumeric(g[1]),WebInspector.Color._parseSatLightNumeric(g[2]),WebInspector.Color._parseAlphaNumeric(g[3])],l=WebInspector.Color._hsl2rgb(d);return new WebInspector.Color(l,WebInspector.Color.Format.HSLA,e)}}return null},WebInspector.Color.fromRGBA=function(e){return new WebInspector.Color([e[0]/255,e[1]/255,e[2]/255,e[3]])},WebInspector.Color.fromHSVA=function(e){var t=e[0],n=e[1],r=e[2],i=(2-n)*r;r===0||n===0?n=0:n*=r/(i<1?i:2-i);var s=[t,n,i/2,e[3]];return new WebInspector.Color(WebInspector.Color._hsl2rgb(s),WebInspector.Color.Format.HSLA)},WebInspector.Color.prototype={format:function(){return this._format},hsla:function(){if(this._hsla)return this._hsla;var e=this._rgba[0],t=this._rgba[1],n=this._rgba[2],r=Math.max(e,t,n),i=Math.min(e,t,n),s=r-i,o=r+i;if(i===r)var u=0;else if(e===r)var u=(1/6*(t-n)/s+1)%1;else if(t===r)var u=1/6*(n-e)/s+1/3;else var u=1/6*(e-t)/s+2/3;var a=.5*o;if(a===0)var f=0;else if(a===1)var f=1;else if(a<=.5)var f=s/o;else var f=s/(2-o);return this._hsla=[u,f,a,this._rgba[3]],this._hsla},hsva:function(){var e=this.hsla(),t=e[0],n=e[1],r=e[2];return n*=r<.5?r:1-r,[t,n!==0?2*n/(r+n):0,r+n,e[3]]},hasAlpha:function(){return this._rgba[3]!==1},canBeShortHex:function(){if(this.hasAlpha())return!1;for(var e=0;e<3;++e){var t=Math.round(this._rgba[e]*255);if(t%17)return!1}return!0},toString:function(e){function t(e){return Math.round(e*255)}function n(e){var t=Math.round(e*255).toString(16);return t.length===1?"0"+t:t}function r(e){return(Math.round(e*255)/17).toString(16)}e||(e=this._format);switch(e){case WebInspector.Color.Format.Original:return this._originalText;case WebInspector.Color.Format.RGB:if(this.hasAlpha())return null;return String.sprintf("rgb(%d, %d, %d)",t(this._rgba[0]),t(this._rgba[1]),t(this._rgba[2]));case WebInspector.Color.Format.RGBA:return String.sprintf("rgba(%d, %d, %d, %f)",t(this._rgba[0]),t(this._rgba[1]),t(this._rgba[2]),this._rgba[3]);case WebInspector.Color.Format.HSL:if(this.hasAlpha())return null;var i=this.hsla();return String.sprintf("hsl(%d, %d%, %d%)",Math.round(i[0]*360),Math.round(i[1]*100),Math.round(i[2]*100));case WebInspector.Color.Format.HSLA:var s=this.hsla();return String.sprintf("hsla(%d, %d%, %d%, %f)",Math.round(s[0]*360),Math.round(s[1]*100),Math.round(s[2]*100),s[3]);case WebInspector.Color.Format.HEX:if(this.hasAlpha())return null;return String.sprintf("#%s%s%s",n(this._rgba[0]),n(this._rgba[1]),n(this._rgba[2])).toUpperCase();case WebInspector.Color.Format.ShortHEX:if(!this.canBeShortHex())return null;return String.sprintf("#%s%s%s",r(this._rgba[0]),r(this._rgba[1]),r(this._rgba[2])).toUpperCase();case WebInspector.Color.Format.Nickname:return this.nickname()}return this._originalText},_canonicalRGBA:function(){var e=new Array(3);for(var t=0;t<3;++t)e[t]=Math.round(this._rgba[t]*255);return this._rgba[3]!==1&&e.push(this._rgba[3]),e},nickname:function(){if(!WebInspector.Color._rgbaToNickname){WebInspector.Color._rgbaToNickname={};for(var e in WebInspector.Color.Nicknames){var t=WebInspector.Color.Nicknames[e];WebInspector.Color._rgbaToNickname[t]=e}}return WebInspector.Color._rgbaToNickname[this._canonicalRGBA()]||null},toProtocolRGBA:function(){var e=this._canonicalRGBA(),t={r:e[0],g:e[1],b:e[2]};return e[3]!==1&&(t.a=e[3]),t}},WebInspector.Color._parseRgbNumeric=function(e){var t=parseInt(e,10);return e.indexOf("%")!==-1?t/=100:t/=255,t},WebInspector.Color._parseHueNumeric=function(e){return isNaN(e)?0:parseFloat(e)/360%1},WebInspector.Color._parseSatLightNumeric=function(e){return parseFloat(e)/100},WebInspector.Color._parseAlphaNumeric=function(e){return isNaN(e)?0:parseFloat(e)},WebInspector.Color._hsl2rgb=function(e){function i(e,t,n){return n<0?n+=1:n>1&&(n-=1),n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var t=e[0],n=e[1],r=e[2];n<0&&(n=0);if(r<=.5)var s=r*(1+n);else var s=r+n-r*n;var o=2*r-s,u=t+1/3,a=t,f=t-1/3,l=i(o,s,u),c=i(o,s,a),h=i(o,s,f);return[l,c,h,e[3]]},WebInspector.Color.Nicknames={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerBlue:[100,149,237],cornsilk:[255,248,220],crimson:[237,20,61],cyan:[0,255,255],darkBlue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,134,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dodgerBlue:[30,144,255],fireBrick:[178,34,34],floralWhite:[255,250,240],forestGreen:[34,139,34],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],honeyDew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightBlue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquaMarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midnightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderBlue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seaShell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[112,128,144],snow:[255,250,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,50],transparent:[0,0,0,0]},WebInspector.Color.PageHighlight={Content:WebInspector.Color.fromRGBA([111,168,220,.66]),ContentLight:WebInspector.Color.fromRGBA([111,168,220,.5]),ContentOutline:WebInspector.Color.fromRGBA([9,83,148]),Padding:WebInspector.Color.fromRGBA([147,196,125,.55]),PaddingLight:WebInspector.Color.fromRGBA([147,196,125,.4]),Border:WebInspector.Color.fromRGBA([255,229,153,.66]),BorderLight:WebInspector.Color.fromRGBA([255,229,153,.5]),Margin:WebInspector.Color.fromRGBA([246,178,107,.66]),MarginLight:WebInspector.Color.fromRGBA([246,178,107,.5]),EventTarget:WebInspector.Color.fromRGBA([255,196,196,.66])},WebInspector.Color.Format={Original:"original",Nickname:"nickname",HEX:"hex",ShortHEX:"shorthex",RGB:"rgb",RGBA:"rgba",HSL:"hsl",HSLA:"hsla"};