/*
 * Copyright (C) 2008 Apple Inc. All Rights Reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

const UserInitiatedProfileName="org.webkit.profiles.user-initiated";WebInspector.ProfileType=function(e,t){this._id=e,this._name=t,this._profiles=[],this._profilesIdMap={},this.treeElement=null},WebInspector.ProfileType.Events={AddProfileHeader:"add-profile-header",RemoveProfileHeader:"remove-profile-header",ProgressUpdated:"progress-updated",ViewUpdated:"view-updated"},WebInspector.ProfileType.prototype={hasTemporaryView:function(){return!1},fileExtension:function(){return null},get statusBarItems(){return[]},get buttonTooltip(){return""},get id(){return this._id},get treeItemTitle(){return this._name},get name(){return this._name},buttonClicked:function(){return!1},get description(){return""},isInstantProfile:function(){return!1},isEnabled:function(){return!0},getProfiles:function(){return this._profiles.filter(function(e){return!e.isTemporary})},decorationElement:function(){return null},getProfile:function(e){return this._profilesIdMap[this._makeKey(e)]},createTemporaryProfile:function(e){throw new Error("Needs implemented.")},createProfile:function(e){throw new Error("Not supported for "+this._name+" profiles.")},_makeKey:function(e){return e+"/"+escape(this.id)},addProfile:function(e){this._profiles.push(e),this._profilesIdMap[this._makeKey(e.uid)]=e,this.dispatchEventToListeners(WebInspector.ProfileType.Events.AddProfileHeader,e)},removeProfile:function(e){for(var t=0;t<this._profiles.length;++t)if(this._profiles[t].uid===e.uid){this._profiles.splice(t,1);break}delete this._profilesIdMap[this._makeKey(e.uid)]},findTemporaryProfile:function(){for(var e=0;e<this._profiles.length;++e)if(this._profiles[e].isTemporary)return this._profiles[e];return null},_reset:function(){var e=this._profiles.slice(0);for(var t=0;t<e.length;++t){var n=e[t],r=n.existingView();r&&(r.detach(),"dispose"in r&&r.dispose()),this.dispatchEventToListeners(WebInspector.ProfileType.Events.RemoveProfileHeader,n)}this.treeElement.removeChildren(),this._profiles=[],this._profilesIdMap={}},_requestProfilesFromBackend:function(e){},_populateProfiles:function(){function e(e,t){if(e)return;t.sort(function(e,t){return e.uid-t.uid});var n=t.length;for(var r=0;r<n;++r)this.addProfile(this.createProfile(t[r]))}this._requestProfilesFromBackend(e.bind(this))},__proto__:WebInspector.Object.prototype},WebInspector.ProfileHeader=function(e,t,n){this._profileType=e,this.title=t,this.isTemporary=n===undefined,this.uid=this.isTemporary?-1:n,this._fromFile=!1},WebInspector.ProfileHeader.prototype={profileType:function(){return this._profileType},createSidebarTreeElement:function(){throw new Error("Needs implemented.")},existingView:function(){return this._view},view:function(e){return this._view||(this._view=this.createView(e)),this._view},createView:function(e){throw new Error("Not implemented.")},dispose:function(){},load:function(e){},canSaveToFile:function(){return!1},saveToFile:function(){throw new Error("Needs implemented")},loadFromFile:function(e){throw new Error("Needs implemented")},fromFile:function(){return this._fromFile},setFromFile:function(){this._fromFile=!0,this.uid=-2}},WebInspector.ProfilesPanel=function(e,t){var n=typeof e!="undefined";e=e||"profiles",WebInspector.Panel.call(this,e),this.registerRequiredCSS("panelEnablerView.css"),this.registerRequiredCSS("heapProfiler.css"),this.registerRequiredCSS("profilesPanel.css"),this.createSidebarViewWithTree(),this.profilesItemTreeElement=new WebInspector.ProfilesSidebarTreeElement(this),this.sidebarTree.appendChild(this.profilesItemTreeElement),this._singleProfileMode=n,this._profileTypesByIdMap={},this.profileViews=document.createElement("div"),this.profileViews.id="profile-views",this.splitView.mainElement.appendChild(this.profileViews),this._statusBarButtons=[],this.recordButton=new WebInspector.StatusBarButton("","record-profile-status-bar-item"),this.recordButton.addEventListener("click",this.toggleRecordButton,this),this._statusBarButtons.push(this.recordButton),this.clearResultsButton=new WebInspector.StatusBarButton(WebInspector.UIString("Clear all profiles."),"clear-status-bar-item"),this.clearResultsButton.addEventListener("click",this._clearProfiles,this),this._statusBarButtons.push(this.clearResultsButton),this._profileTypeStatusBarItemsContainer=document.createElement("div"),this._profileTypeStatusBarItemsContainer.className="status-bar-items",this._profileViewStatusBarItemsContainer=document.createElement("div"),this._profileViewStatusBarItemsContainer.className="status-bar-items",n?(this._launcherView=this._createLauncherView(),this._registerProfileType(t),this._selectedProfileType=t,this._updateProfileTypeSpecificUI()):(this._launcherView=new WebInspector.MultiProfileLauncherView(this),this._launcherView.addEventListener(WebInspector.MultiProfileLauncherView.EventTypes.ProfileTypeSelected,this._onProfileTypeSelected,this),this._registerProfileType(new WebInspector.CPUProfileType),this._registerProfileType(new WebInspector.HeapSnapshotProfileType),this._registerProfileType(new WebInspector.TrackingHeapSnapshotProfileType(this)),!WebInspector.WorkerManager.isWorkerFrontend()&&WebInspector.experimentsSettings.canvasInspection.isEnabled()&&this._registerProfileType(new WebInspector.CanvasProfileType)),this._profilesWereRequested=!1,this._reset(),this._createFileSelectorElement(),this.element.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this),!0),this._registerShortcuts(),WebInspector.ContextMenu.registerProvider(this)},WebInspector.ProfilesPanel.prototype={_createFileSelectorElement:function(){this._fileSelectorElement&&this.element.removeChild(this._fileSelectorElement),this._fileSelectorElement=WebInspector.createFileSelectorElement(this._loadFromFile.bind(this)),this.element.appendChild(this._fileSelectorElement)},_createLauncherView:function(){return new WebInspector.ProfileLauncherView(this)},_findProfileTypeByExtension:function(e){for(var t in this._profileTypesByIdMap){var n=this._profileTypesByIdMap[t],r=n.fileExtension();if(!r)continue;if(e.endsWith(n.fileExtension()))return n}return null},_registerShortcuts:function(){this.registerShortcuts(WebInspector.ProfilesPanelDescriptor.ShortcutKeys.StartStopRecording,this.toggleRecordButton.bind(this))},_loadFromFile:function(e){this._createFileSelectorElement();var t=this._findProfileTypeByExtension(e.name);if(!t){var n=[];for(var r in this._profileTypesByIdMap){var i=this._profileTypesByIdMap[r].fileExtension();if(!i)continue;n.push(i)}WebInspector.log(WebInspector.UIString("Can't load file. Only files with extensions '%s' can be loaded.",n.join("', '")));return}if(!!t.findTemporaryProfile()){WebInspector.log(WebInspector.UIString("Can't load profile when other profile is recording."));return}var s=t.createTemporaryProfile(WebInspector.ProfilesPanelDescriptor.UserInitiatedProfileName+"."+e.name);s.setFromFile(),t.addProfile(s),s.loadFromFile(e)},get statusBarItems(){return this._statusBarButtons.select("element").concat(this._profileTypeStatusBarItemsContainer,this._profileViewStatusBarItemsContainer)},toggleRecordButton:function(e){var t=this._selectedProfileType.buttonClicked();return this.setRecordingProfile(this._selectedProfileType.id,t),!0},_populateAllProfiles:function(){if(this._profilesWereRequested)return;this._profilesWereRequested=!0;for(var e in this._profileTypesByIdMap)this._profileTypesByIdMap[e]._populateProfiles()},wasShown:function(){WebInspector.Panel.prototype.wasShown.call(this),this._populateAllProfiles()},_onProfileTypeSelected:function(e){this._selectedProfileType=e.data,this._updateProfileTypeSpecificUI()},_updateProfileTypeSpecificUI:function(){this.recordButton.title=this._selectedProfileType.buttonTooltip,this._launcherView.updateProfileType(this._selectedProfileType),this._profileTypeStatusBarItemsContainer.removeChildren();var e=this._selectedProfileType.statusBarItems;if(e)for(var t=0;t<e.length;++t)this._profileTypeStatusBarItemsContainer.appendChild(e[t]);this._resize(this.splitView.sidebarWidth())},_reset:function(){WebInspector.Panel.prototype.reset.call(this);for(var e in this._profileTypesByIdMap)this._profileTypesByIdMap[e]._reset();delete this.visibleView,delete this.currentQuery,this.searchCanceled(),this._profileGroups={},this.recordButton.toggled=!1,this._selectedProfileType&&(this.recordButton.title=this._selectedProfileType.buttonTooltip),this._launcherView.profileFinished(),this.sidebarTreeElement.removeStyleClass("some-expandable"),this.profileViews.removeChildren(),this._profileViewStatusBarItemsContainer.removeChildren(),this.removeAllListeners(),this.recordButton.visible=!0,this._profileViewStatusBarItemsContainer.removeStyleClass("hidden"),this.clearResultsButton.element.removeStyleClass("hidden"),this.profilesItemTreeElement.select(),this._showLauncherView()},_showLauncherView:function(){this.closeVisibleView(),this._profileViewStatusBarItemsContainer.removeChildren(),this._launcherView.show(this.splitView.mainElement),this.visibleView=this._launcherView},_clearProfiles:function(){ProfilerAgent.clearProfiles(),HeapProfilerAgent.clearProfiles(),this._reset()},_garbageCollectButtonClicked:function(){HeapProfilerAgent.collectGarbage()},_registerProfileType:function(e){function t(e){this._addProfileHeader(e.data)}function n(e){this._removeProfileHeader(e.data)}function r(e){this._reportProfileProgress(e.data.profile,e.data.done,e.data.total)}this._profileTypesByIdMap[e.id]=e,this._launcherView.addProfileType(e),e.treeElement=new WebInspector.SidebarSectionTreeElement(e.treeItemTitle,null,!0),e.treeElement.hidden=!this._singleProfileMode,this.sidebarTree.appendChild(e.treeElement),e.treeElement.childrenListElement.addEventListener("contextmenu",this._handleContextMenuEvent.bind(this),!0),e.addEventListener(WebInspector.ProfileType.Events.ViewUpdated,this._updateProfileTypeSpecificUI,this),e.addEventListener(WebInspector.ProfileType.Events.AddProfileHeader,t,this),e.addEventListener(WebInspector.ProfileType.Events.RemoveProfileHeader,n,this),e.addEventListener(WebInspector.ProfileType.Events.ProgressUpdated,r,this)},_handleContextMenuEvent:function(e){var t=e.srcElement;while(t&&!t.treeElement&&t!==this.element)t=t.parentElement;if(!t)return;if(t.treeElement&&t.treeElement.handleContextMenuEvent){t.treeElement.handleContextMenuEvent(e,this);return}var n=new WebInspector.ContextMenu(e);this.visibleView instanceof WebInspector.HeapSnapshotView&&this.visibleView.populateContextMenu(n,e),(t!==this.element||e.srcElement===this.sidebarElement)&&n.appendItem(WebInspector.UIString("Load…"),this._fileSelectorElement.click.bind(this._fileSelectorElement)),n.show()},_makeTitleKey:function(e,t){return escape(e)+"/"+escape(t)},_addProfileHeader:function(e){var t=e.profileType(),n=t.id,r=t.treeElement;r.hidden=!1;var i=!1,s;if(!WebInspector.ProfilesPanelDescriptor.isUserInitiatedProfile(e.title)&&!e.isTemporary){var o=this._makeTitleKey(e.title,n);o in this._profileGroups||(this._profileGroups[o]=[]);var u=this._profileGroups[o];u.push(e);if(u.length===2){u._profilesTreeElement=new WebInspector.ProfileGroupSidebarTreeElement(this,e.title);var a=r.children.indexOf(u[0]._profilesTreeElement);r.insertChild(u._profilesTreeElement,a);var f=u[0]._profilesTreeElement.selected;r.removeChild(u[0]._profilesTreeElement),u._profilesTreeElement.appendChild(u[0]._profilesTreeElement),f&&u[0]._profilesTreeElement.revealAndSelect(),u[0]._profilesTreeElement.small=!0,u[0]._profilesTreeElement.mainTitle=WebInspector.UIString("Run %d",1),this.sidebarTreeElement.addStyleClass("some-expandable")}u.length>=2&&(r=u._profilesTreeElement,s=WebInspector.UIString("Run %d",u.length),i=!0)}var l=e.createSidebarTreeElement();e.sidebarElement=l,l.small=i,s&&(l.mainTitle=s),e._profilesTreeElement=l;var c=t.findTemporaryProfile();e.isTemporary||!c?r.appendChild(l):(c&&(r.insertBeforeChild(l,c._profilesTreeElement),this._removeTemporaryProfile(e.profileType().id)),(!this.visibleView||this.visibleView===this._launcherView)&&this._showProfile(e),this.dispatchEventToListeners("profile added",{type:n}))},_removeProfileHeader:function(e){e.dispose(),e.profileType().removeProfile(e);var t=e.profileType().treeElement,n=this._makeTitleKey(e.title,e.profileType().id),r=this._profileGroups[n];if(r){r.splice(r.indexOf(e),1);if(r.length===1){var i=t.children.indexOf(r._profilesTreeElement);t.insertChild(r[0]._profilesTreeElement,i),r[0]._profilesTreeElement.small=!1,r[0]._profilesTreeElement.mainTitle=r[0].title,t.removeChild(r._profilesTreeElement)}r.length!==0?t=r._profilesTreeElement:delete this._profileGroups[n]}t.removeChild(e._profilesTreeElement),t.children.length||(this.profilesItemTreeElement.select(),this._showLauncherView(),t.hidden=!this._singleProfileMode)},_showProfile:function(e){if(!e||e.isTemporary&&!e.profileType().hasTemporaryView())return null;var t=e.view(this);if(t===this.visibleView)return t;this.closeVisibleView(),t.show(this.profileViews),e._profilesTreeElement._suppressOnSelect=!0,e._profilesTreeElement.revealAndSelect(),delete e._profilesTreeElement._suppressOnSelect,this.visibleView=t,this._profileViewStatusBarItemsContainer.removeChildren();var n=t.statusBarItems;if(n)for(var r=0;r<n.length;++r)this._profileViewStatusBarItemsContainer.appendChild(n[r]);return t},showObject:function(e,t){var n=this.getProfileType(WebInspector.HeapSnapshotProfileType.TypeId).getProfiles();for(var r=0;r<n.length;r++){var i=n[r];if(i.maxJSObjectId>=e){this._showProfile(i);var s=i.view(this);s.changeView(t,function(){s.dataGrid.highlightObjectByHeapSnapshotId(e)});break}}},_createTemporaryProfile:function(e){var t=this.getProfileType(e);t.findTemporaryProfile()||t.addProfile(t.createTemporaryProfile())},_removeTemporaryProfile:function(e){var t=this.getProfileType(e).findTemporaryProfile();!t||this._removeProfileHeader(t)},getProfile:function(e,t){return this.getProfileType(e).getProfile(t)},showView:function(e){this._showProfile(e.profile)},getProfileType:function(e){return this._profileTypesByIdMap[e]},showProfile:function(e,t){return this._showProfile(this.getProfile(e,Number(t)))},closeVisibleView:function(){this.visibleView&&this.visibleView.detach(),delete this.visibleView},performSearch:function(e,t){function s(){WebInspector.searchController.updateSearchMatchesCount(this._totalSearchMatches,this),WebInspector.searchController.updateCurrentMatchIndex(this._currentSearchResultIndex,this),i=null}function o(){if(i)return;i=setTimeout(s.bind(this),500)}function u(e,n){if(!n)return;this._totalSearchMatches+=n,this._searchResults.push(e),this.searchMatchFound(e,n),o.call(this),t&&e===r&&e.jumpToFirstSearchResult()}function h(){var t=n[a];++a>=n.length&&(f._currentSearchChunkIntervalIdentifier===c&&delete f._currentSearchChunkIntervalIdentifier,clearInterval(c));if(!t)return;t.currentQuery=e,t.performSearch(e,l)}this.searchCanceled();var n=this._searchableViews();if(!n||!n.length)return;var r=this.visibleView,i=null,a=0,f=this,l=u.bind(this),c=null;h(),c=setInterval(h,25),this._currentSearchChunkIntervalIdentifier=c},jumpToNextSearchResult:function(){if(!this.showView||!this._searchResults||!this._searchResults.length)return;var e=!1;this._currentSearchResultIndex=this._searchResults.indexOf(this.visibleView),this._currentSearchResultIndex===-1&&(this._currentSearchResultIndex=0,e=!0);var t=this._searchResults[this._currentSearchResultIndex];t.showingLastSearchResult()&&(++this._currentSearchResultIndex>=this._searchResults.length&&(this._currentSearchResultIndex=0),t=this._searchResults[this._currentSearchResultIndex],e=!0),WebInspector.searchController.updateCurrentMatchIndex(this._currentSearchResultIndex,this),t!==this.visibleView&&(this.showView(t),WebInspector.searchController.showSearchField()),e?t.jumpToFirstSearchResult():t.jumpToNextSearchResult()},jumpToPreviousSearchResult:function(){if(!this.showView||!this._searchResults||!this._searchResults.length)return;var e=!1;this._currentSearchResultIndex=this._searchResults.indexOf(this.visibleView),this._currentSearchResultIndex===-1&&(this._currentSearchResultIndex=0,e=!0);var t=this._searchResults[this._currentSearchResultIndex];t.showingFirstSearchResult()&&(--this._currentSearchResultIndex<0&&(this._currentSearchResultIndex=this._searchResults.length-1),t=this._searchResults[this._currentSearchResultIndex],e=!0),WebInspector.searchController.updateCurrentMatchIndex(this._currentSearchResultIndex,this),t!==this.visibleView&&(this.showView(t),WebInspector.searchController.showSearchField()),e?t.jumpToLastSearchResult():t.jumpToPreviousSearchResult()},_getAllProfiles:function(){var e=[];for(var t in this._profileTypesByIdMap)e=e.concat(this._profileTypesByIdMap[t].getProfiles());return e},_searchableViews:function(){var e=this._getAllProfiles(),t=[];for(var n=0;n<e.length;++n){var r=e[n].view(this);r.performSearch&&t.push(r)}var i=t.indexOf(this.visibleView);return i>0&&(t[i]=t[0],t[0]=this.visibleView),t},searchMatchFound:function(e,t){e.profile._profilesTreeElement.searchMatches=t},searchCanceled:function(){if(this._searchResults)for(var e=0;e<this._searchResults.length;++e){var t=this._searchResults[e];t.searchCanceled&&t.searchCanceled(),delete t.currentQuery}WebInspector.Panel.prototype.searchCanceled.call(this),this._currentSearchChunkIntervalIdentifier&&(clearInterval(this._currentSearchChunkIntervalIdentifier),delete this._currentSearchChunkIntervalIdentifier),this._totalSearchMatches=0,this._currentSearchResultIndex=0,this._searchResults=[];var n=this._getAllProfiles();for(var e=0;e<n.length;++e)n[e]._profilesTreeElement.searchMatches=0},sidebarResized:function(e){var t=e.data;this._resize(t)},onResize:function(){this._resize(this.splitView.sidebarWidth())},_resize:function(e){var t=this._statusBarButtons[this._statusBarButtons.length-1].element,n=t.totalOffsetLeft()+t.offsetWidth;this._profileTypeStatusBarItemsContainer.style.left=n+"px",n+=this._profileTypeStatusBarItemsContainer.offsetWidth-1,this._profileViewStatusBarItemsContainer.style.left=Math.max(n,e)+"px"},setRecordingProfile:function(e,t){var n=this.getProfileType(e);this.recordButton.toggled=t,this.recordButton.title=n.buttonTooltip,t?(this._launcherView.profileStarted(),this._createTemporaryProfile(e),n.hasTemporaryView()&&this._showProfile(n.findTemporaryProfile())):this._launcherView.profileFinished()},_reportProfileProgress:function(e,t,n){e.sidebarElement.subtitle=WebInspector.UIString("%.0f%",t/n*100),e.sidebarElement.wait=!0},appendApplicableItems:function(e,t,n){function o(e){HeapProfilerAgent.getHeapObjectId(i,u.bind(this,e))}function u(e,t,n){if(WebInspector.inspectorView.currentPanel()!==this)return;t||this.showObject(n,e)}if(WebInspector.inspectorView.currentPanel()!==this)return;var r=n,i=r.objectId;if(!i)return;var s=this.getProfileType(WebInspector.HeapSnapshotProfileType.TypeId).getProfiles();if(!s.length)return;t.appendItem(WebInspector.UIString(WebInspector.useLowerCaseMenuTitles()?"Reveal in Dominators view":"Reveal in Dominators View"),o.bind(this,"Dominators")),t.appendItem(WebInspector.UIString(WebInspector.useLowerCaseMenuTitles()?"Reveal in Summary view":"Reveal in Summary View"),o.bind(this,"Summary"))},__proto__:WebInspector.Panel.prototype},WebInspector.ProfileSidebarTreeElement=function(e,t,n){this.profile=e,this._titleFormat=t,WebInspector.ProfilesPanelDescriptor.isUserInitiatedProfile(this.profile.title)&&(this._profileNumber=WebInspector.ProfilesPanelDescriptor.userInitiatedProfileIndex(this.profile.title)),WebInspector.SidebarTreeElement.call(this,n,"","",e,!1),this.refreshTitles()},WebInspector.ProfileSidebarTreeElement.prototype={onselect:function(){this._suppressOnSelect||this.treeOutline.panel._showProfile(this.profile)},ondelete:function(){return this.treeOutline.panel._removeProfileHeader(this.profile),!0},get mainTitle(){return this._mainTitle?this._mainTitle:WebInspector.ProfilesPanelDescriptor.isUserInitiatedProfile(this.profile.title)?WebInspector.UIString(this._titleFormat,this._profileNumber):this.profile.title},set mainTitle(e){this._mainTitle=e,this.refreshTitles()},set searchMatches(e){if(!e){if(!this.bubbleElement)return;this.bubbleElement.removeStyleClass("search-matches"),this.bubbleText="";return}this.bubbleText=e,this.bubbleElement.addStyleClass("search-matches")},handleContextMenuEvent:function(e,t){var n=this.profile,r=new WebInspector.ContextMenu(e);r.appendItem(WebInspector.UIString("Load…"),t._fileSelectorElement.click.bind(t._fileSelectorElement)),n.canSaveToFile()&&r.appendItem(WebInspector.UIString("Save…"),n.saveToFile.bind(n)),r.appendItem(WebInspector.UIString("Delete"),this.ondelete.bind(this)),r.show()},__proto__:WebInspector.SidebarTreeElement.prototype},WebInspector.ProfileGroupSidebarTreeElement=function(e,t,n){WebInspector.SidebarTreeElement.call(this,"profile-group-sidebar-tree-item",t,n,null,!0),this._panel=e},WebInspector.ProfileGroupSidebarTreeElement.prototype={onselect:function(){this.children.length>0&&this._panel._showProfile(this.children[this.children.length-1].profile)},__proto__:WebInspector.SidebarTreeElement.prototype},WebInspector.ProfilesSidebarTreeElement=function(e){this._panel=e,this.small=!1,WebInspector.SidebarTreeElement.call(this,"profile-launcher-view-tree-item",WebInspector.UIString("Profiles"),"",null,!1)},WebInspector.ProfilesSidebarTreeElement.prototype={onselect:function(){this._panel._showLauncherView()},get selectable(){return!0},__proto__:WebInspector.SidebarTreeElement.prototype},WebInspector.CPUProfilerPanel=function(){WebInspector.ProfilesPanel.call(this,"cpu-profiler",new WebInspector.CPUProfileType)},WebInspector.CPUProfilerPanel.prototype={__proto__:WebInspector.ProfilesPanel.prototype},WebInspector.HeapProfilerPanel=function(){var e=new WebInspector.HeapSnapshotProfileType;WebInspector.ProfilesPanel.call(this,"heap-profiler",e),this._singleProfileMode=!1,this._registerProfileType(new WebInspector.TrackingHeapSnapshotProfileType(this)),this._launcherView.addEventListener(WebInspector.MultiProfileLauncherView.EventTypes.ProfileTypeSelected,this._onProfileTypeSelected,this),this._launcherView._profileTypeChanged(e)},WebInspector.HeapProfilerPanel.prototype={_createLauncherView:function(){return new WebInspector.MultiProfileLauncherView(this)},__proto__:WebInspector.ProfilesPanel.prototype},WebInspector.CanvasProfilerPanel=function(){WebInspector.ProfilesPanel.call(this,"canvas-profiler",new WebInspector.CanvasProfileType)},WebInspector.CanvasProfilerPanel.prototype={__proto__:WebInspector.ProfilesPanel.prototype},importScript("ProfileDataGridTree.js"),importScript("BottomUpProfileDataGridTree.js"),importScript("CPUProfileView.js"),importScript("FlameChart.js"),importScript("HeapSnapshot.js"),importScript("HeapSnapshotDataGrids.js"),importScript("HeapSnapshotGridNodes.js"),importScript("HeapSnapshotLoader.js"),importScript("HeapSnapshotProxy.js"),importScript("HeapSnapshotView.js"),importScript("HeapSnapshotWorkerDispatcher.js"),importScript("JSHeapSnapshot.js"),importScript("ProfileLauncherView.js"),importScript("TopDownProfileDataGridTree.js"),importScript("CanvasProfileView.js"),importScript("CanvasReplayStateView.js");