function Strategy(e,t){typeof e=="function"&&(t=e,e={});if(!t)throw new Error("local authentication strategy requires a verify function");this._usernameField=e.usernameField||"username",this._passwordField=e.passwordField||"password",passport.Strategy.call(this),this.name="local",this._verify=t,this._passReqToCallback=e.passReqToCallback}var passport=require("passport"),util=require("util"),BadRequestError=require("./errors/badrequesterror");util.inherits(Strategy,passport.Strategy),Strategy.prototype.authenticate=function(e,t){function s(e,t,n){if(e)return i.error(e);if(!t)return i.fail(n);i.success(t,n)}function o(e,t){if(!e)return null;var n=t.split("]").join("").split("[");for(var r=0,i=n.length;r<i;r++){var s=e[n[r]];if(typeof s=="undefined")return null;if(typeof s!="object")return s;e=s}return null}t=t||{};var n=o(e.body,this._usernameField)||o(e.query,this._usernameField),r=o(e.body,this._passwordField)||o(e.query,this._passwordField);if(!n||!r)return this.fail(new BadRequestError(t.badRequestMessage||"Missing credentials"));var i=this;i._passReqToCallback?this._verify(e,n,r,s):this._verify(n,r,s)},module.exports=Strategy;