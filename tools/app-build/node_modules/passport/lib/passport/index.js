function Passport(){this._key="passport",this._strategies={},this._serializers=[],this._deserializers=[],this._infoTransformers=[],this._framework=null,this._userProperty="user",this.use(new SessionStrategy)}var fs=require("fs"),path=require("path"),util=require("util"),Strategy=require("./strategy"),SessionStrategy=require("./strategies/session"),initialize=require("./middleware/initialize"),authenticate=require("./middleware/authenticate");Passport.prototype.use=function(e,t){t||(t=e,e=t.name);if(!e)throw new Error("authentication strategies must have a name");return this._strategies[e]=t,this},Passport.prototype.unuse=function(e){return delete this._strategies[e],this},Passport.prototype.framework=function(e){return this._framework=e,this},Passport.prototype.initialize=function(e){return e=e||{},this._userProperty=e.userProperty||"user",this._framework&&this._framework.initialize?this._framework.initialize().bind(this):initialize().bind(this)},Passport.prototype.session=function(e){return this.authenticate("session",e)},Passport.prototype.authenticate=function(e,t,n){return this._framework&&this._framework.authenticate?this._framework.authenticate(e,t,n).bind(this):authenticate(e,t,n).bind(this)},Passport.prototype.authorize=function(e,t,n){var r=this._framework&&(this._framework.authorize||this._framework.authenticate);return t=t||{},t.assignProperty="account",r?r(e,t,n).bind(this):authenticate(e,t,n).bind(this)},Passport.prototype.serializeUser=function(e,t){if(typeof e=="function")return this._serializers.push(e);var n=e,r=this._serializers;(function i(e,s,o){"pass"===s&&(s=undefined);if(s||o||o===0)return t(s,o);var u=r[e];if(!u)return t(new Error("failed to serialize user into session"));try{u(n,function(t,n){i(e+1,t,n)})}catch(a){return t(a)}})(0)},Passport.prototype.deserializeUser=function(e,t){if(typeof e=="function")return this._deserializers.push(e);var n=e,r=this._deserializers;(function i(e,s,o){"pass"===s&&(s=undefined);if(s||o)return t(s,o);if(o===null||o===!1)return t(null,!1);var u=r[e];if(!u)return t(new Error("failed to deserialize user out of session"));try{u(n,function(t,n){i(e+1,t,n)})}catch(a){return t(a)}})(0)},Passport.prototype.transformAuthInfo=function(e,t){if(typeof e=="function")return this._infoTransformers.push(e);var n=e,r=this._infoTransformers;(function i(e,s,o){"pass"===s&&(s=undefined);if(s||o)return t(s,o);var u=r[e];if(!u)return t(null,n);try{var a=u.length;if(a==1){var f=u(n);i(e+1,null,f)}else u(n,function(t,n){i(e+1,t,n)})}catch(l){return t(l)}})(0)},Passport.prototype._strategy=function(e){return this._strategies[e]},exports=module.exports=new Passport,require("pkginfo")(module,"version"),exports.Passport=Passport,exports.Strategy=Strategy,exports.strategies={},exports.strategies.SessionStrategy=SessionStrategy,require("./http/request");