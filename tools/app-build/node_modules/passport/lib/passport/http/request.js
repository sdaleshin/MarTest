var http=require("http"),req=http.IncomingMessage.prototype;req.login=req.logIn=function(e,t,n){if(!this._passport)throw new Error("passport.initialize() middleware not in use");!n&&typeof t=="function"&&(n=t,t={}),t=t||{};var r=this._passport.instance._userProperty||"user",i=t.session===undefined?!0:t.session;this[r]=e;if(i){var s=this;this._passport.instance.serializeUser(e,function(e,t){if(e)return s[r]=null,n(e);s._passport.session.user=t,n()})}else n&&n()},req.logout=req.logOut=function(){if(!this._passport)throw new Error("passport.initialize() middleware not in use");var e=this._passport.instance._userProperty||"user";this[e]=null,delete this._passport.session.user},req.isAuthenticated=function(){var e="user";return this._passport&&this._passport.instance._userProperty&&(e=this._passport.instance._userProperty),this[e]?!0:!1},req.isUnauthenticated=function(){return!this.isAuthenticated()};